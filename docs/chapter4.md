# Chapter 4: GUI ê°œì„ ê³¼ ì‚¬ìš©ì„± í–¥ìƒ

ì´ë²ˆ ì±•í„°ì—ì„œëŠ” Chapter 3ì—ì„œ ë§Œë“  ê¸°ë³¸ í”„ë¡œê·¸ë¨ì„ ë°”íƒ•ìœ¼ë¡œ ì‚¬ìš©ì ì¹œí™”ì ì¸ GUIë¡œ ê°œì„ í•´ë³´ê² ìŠµë‹ˆë‹¤. **ë“œë˜ê·¸ ì•¤ ë“œë¡­**, **ì°¾ê¸°/ë°”ê¾¸ê¸°**, **í–¥ìƒëœ íŒŒì¼ ê´€ë¦¬** ê¸°ëŠ¥ì„ ë‹¨ê³„ì ìœ¼ë¡œ ì¶”ê°€í•˜ë©´ì„œ ì‹¤ìš©ì ì¸ íŒŒì¼ ë¦¬ë„¤ì´ë¨¸ë¥¼ ì™„ì„±í•´ë³´ê² ìŠµë‹ˆë‹¤.

## ğŸ¯ í•™ìŠµ ëª©í‘œ

- Chapter 3ì˜ ê¸°ë³¸ í”„ë¡œê·¸ë¨ì„ GUIë¡œ ë°œì „ì‹œí‚¤ê¸°
- ì‚¬ìš©ì ì¹œí™”ì ì¸ ì¸í„°í˜ì´ìŠ¤ ì„¤ê³„ ì›ì¹™ í•™ìŠµ
- ë“œë˜ê·¸ ì•¤ ë“œë¡­ ê¸°ëŠ¥ìœ¼ë¡œ í¸ì˜ì„± í–¥ìƒ
- ì°¾ê¸°/ë°”ê¾¸ê¸° ê¸°ëŠ¥ìœ¼ë¡œ ìœ ì—°ì„± í™•ë³´
- ì—ëŸ¬ ì²˜ë¦¬ì™€ ì‚¬ìš©ì í”¼ë“œë°± êµ¬í˜„

## ğŸ—ï¸ Chapter 3ì—ì„œ Chapter 4ë¡œì˜ ë°œì „

Chapter 3ì—ì„œ ìš°ë¦¬ëŠ” ì½˜ì†” ê¸°ë°˜ì˜ ê°„ë‹¨í•œ íŒŒì¼ ë¦¬ë„¤ì´ë¨¸ë¥¼ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤. ì´ì œ ì´ë¥¼ ë‹¨ê³„ë³„ë¡œ GUI í”„ë¡œê·¸ë¨ìœ¼ë¡œ ë°œì „ì‹œì¼œë³´ê² ìŠµë‹ˆë‹¤.

### Chapter 3 vs Chapter 4 ë¹„êµ

| ì¸¡ë©´ | Chapter 3 | Chapter 4 |
|------|-----------|----------|
| ì¸í„°í˜ì´ìŠ¤ | ì½˜ì†” ê¸°ë°˜ | GUI ê¸°ë°˜ |
| íŒŒì¼ ì¶”ê°€ | ìˆ˜ë™ ê²½ë¡œ ì…ë ¥ | íŒŒì¼ ë‹¤ì´ì–¼ë¡œê·¸ + ë“œë˜ê·¸ì•¤ë“œë¡­ |
| ë¯¸ë¦¬ë³´ê¸° | ë‹¨ìˆœ í…ìŠ¤íŠ¸ ì¶œë ¥ | í…Œì´ë¸” í˜•íƒœ ì‹œê°í™” |
| ì‚¬ìš©ì„± | í”„ë¡œê·¸ë˜ë¨¸ìš© | ì¼ë°˜ ì‚¬ìš©ììš© |
| ê¸°ëŠ¥ | ì ‘ë‘ì‚¬ë§Œ | ì ‘ë‘ì‚¬/ì ‘ë¯¸ì‚¬/ì°¾ê¸°ë°”ê¾¸ê¸° |

## ğŸš€ Step-by-Step ê°œë°œ ê³¼ì •

### ì´ë²ˆ ì±•í„°ì—ì„œ êµ¬í˜„í•  5ë‹¨ê³„

1. **Step 1**: Chapter 3 ì½”ë“œë¥¼ GUIë¡œ ë³€í™˜
2. **Step 2**: íŒŒì¼ ë‹¤ì´ì–¼ë¡œê·¸ë¡œ í¸ì˜ì„± í–¥ìƒ
3. **Step 3**: ë“œë˜ê·¸ ì•¤ ë“œë¡­ìœ¼ë¡œ ì§ê´€ì„± í™•ë³´
4. **Step 4**: ì°¾ê¸°/ë°”ê¾¸ê¸° ê¸°ëŠ¥ìœ¼ë¡œ ìœ ì—°ì„± ì¶”ê°€
5. **Step 5**: íŒŒì¼ ê´€ë¦¬ ê¸°ëŠ¥ìœ¼ë¡œ ì™„ì„±ë„ ë†’ì´ê¸°

### í•„ìˆ˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜

```bash
pip install tkinterdnd2
```

!!! info "ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ëª…"
    tkinterdnd2ëŠ” tkinterì— ë“œë˜ê·¸ ì•¤ ë“œë¡­ ê¸°ëŠ¥ì„ ì¶”ê°€í•˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ì…ë‹ˆë‹¤. ì„¤ì¹˜ê°€ ì–´ë ¤ìš´ ê²½ìš° íŒŒì¼ ë‹¤ì´ì–¼ë¡œê·¸ë§Œìœ¼ë¡œë„ ì¶©ë¶„íˆ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.

## ğŸ“ Step 1: Chapter 3 ì½”ë“œë¥¼ GUIë¡œ ë³€í™˜

### ëª©í‘œ
Chapter 3ì˜ ì½˜ì†” ê¸°ë°˜ í”„ë¡œê·¸ë¨ì„ tkinter GUIë¡œ ë³€í™˜í•˜ì—¬ ê¸°ë³¸ì ì¸ ì‹œê°ì  ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬ì„±í•©ë‹ˆë‹¤.

### step1_basic_gui.py

```python
import tkinter as tk
from tkinter import ttk, filedialog, messagebox
import os

class BasicFileRenamer:
    def __init__(self):
        self.root = tk.Tk()
        self.root.title("íŒŒì¼ ë¦¬ë„¤ì´ë¨¸ v1.0")
        self.root.geometry("600x400")
        
        # Chapter 3ì—ì„œ ì‚¬ìš©í•œ ë³€ìˆ˜ë“¤
        self.files = []
        
        self.create_widgets()
    
    def create_widgets(self):
        # ì œëª©
        title_label = ttk.Label(self.root, text="íŒŒì¼ ì´ë¦„ ë³€ê²½ ë„êµ¬", 
                               font=("ë§‘ì€ ê³ ë”•", 16, "bold"))
        title_label.pack(pady=10)
        
        # íŒŒì¼ ì¶”ê°€ ë²„íŠ¼
        ttk.Button(self.root, text="íŒŒì¼ ì„ íƒ", 
                  command=self.select_files).pack(pady=5)
        
        # íŒŒì¼ ëª©ë¡ í‘œì‹œ (ê°„ë‹¨í•œ ë¦¬ìŠ¤íŠ¸ë°•ìŠ¤)
        self.file_listbox = tk.Listbox(self.root, height=8)
        self.file_listbox.pack(fill="both", expand=True, padx=20, pady=10)
        
        # ì˜µì…˜ í”„ë ˆì„
        option_frame = ttk.Frame(self.root)
        option_frame.pack(fill="x", padx=20, pady=5)
        
        # ì ‘ë‘ì‚¬ ì…ë ¥
        ttk.Label(option_frame, text="ì ‘ë‘ì‚¬:").grid(row=0, column=0, sticky="w")
        self.prefix_var = tk.StringVar()
        self.prefix_entry = ttk.Entry(option_frame, textvariable=self.prefix_var, width=20)
        self.prefix_entry.grid(row=0, column=1, padx=5)
        
        # ë²„íŠ¼ í”„ë ˆì„
        button_frame = ttk.Frame(self.root)
        button_frame.pack(pady=10)
        
        ttk.Button(button_frame, text="ë¯¸ë¦¬ë³´ê¸°", 
                  command=self.preview_changes).pack(side="left", padx=5)
        ttk.Button(button_frame, text="ì‹¤í–‰", 
                  command=self.execute_rename).pack(side="left", padx=5)
        ttk.Button(button_frame, text="ì´ˆê¸°í™”", 
                  command=self.clear_files).pack(side="left", padx=5)
    
    def select_files(self):
        """íŒŒì¼ ì„ íƒ ë‹¤ì´ì–¼ë¡œê·¸"""
        files = filedialog.askopenfilenames(
            title="ì´ë¦„ì„ ë³€ê²½í•  íŒŒì¼ë“¤ì„ ì„ íƒí•˜ì„¸ìš”",
            filetypes=[("ëª¨ë“  íŒŒì¼", "*.*")]
        )
        
        for file_path in files:
            if file_path not in self.files:
                self.files.append(file_path)
        
        self.update_file_list()
    
    def update_file_list(self):
        """íŒŒì¼ ëª©ë¡ ì—…ë°ì´íŠ¸"""
        self.file_listbox.delete(0, tk.END)
        for file_path in self.files:
            filename = os.path.basename(file_path)
            self.file_listbox.insert(tk.END, filename)
    
    def preview_changes(self):
        """Chapter 3ì˜ ë¯¸ë¦¬ë³´ê¸° ê¸°ëŠ¥ì„ GUIë¡œ"""
        if not self.files:
            messagebox.showwarning("ê²½ê³ ", "ì„ íƒëœ íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.")
            return
        
        prefix = self.prefix_var.get().strip()
        if not prefix:
            messagebox.showwarning("ê²½ê³ ", "ì ‘ë‘ì‚¬ë¥¼ ì…ë ¥í•˜ì„¸ìš”.")
            return
        
        # ë¯¸ë¦¬ë³´ê¸° ì°½ ìƒì„±
        preview_window = tk.Toplevel(self.root)
        preview_window.title("ë¯¸ë¦¬ë³´ê¸°")
        preview_window.geometry("500x400")
        
        # ë¯¸ë¦¬ë³´ê¸° í…ìŠ¤íŠ¸ í‘œì‹œ
        text_widget = tk.Text(preview_window, wrap="none")
        scrollbar = ttk.Scrollbar(preview_window, command=text_widget.yview)
        text_widget.configure(yscrollcommand=scrollbar.set)
        
        preview_content = "ë³€ê²½ ì˜ˆì •:\n" + "="*50 + "\n"
        
        for file_path in self.files:
            old_name = os.path.basename(file_path)
            name, ext = os.path.splitext(old_name)
            new_name = f"{prefix}{name}{ext}"
            preview_content += f"{old_name} â†’ {new_name}\n"
        
        text_widget.insert("1.0", preview_content)
        text_widget.configure(state="disabled")
        
        text_widget.pack(side="left", fill="both", expand=True)
        scrollbar.pack(side="right", fill="y")
    
    def execute_rename(self):
        """Chapter 3ì˜ ì‹¤í–‰ ë¡œì§ì„ GUIë¡œ"""
        if not self.files:
            messagebox.showwarning("ê²½ê³ ", "ì„ íƒëœ íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.")
            return
        
        prefix = self.prefix_var.get().strip()
        if not prefix:
            messagebox.showwarning("ê²½ê³ ", "ì ‘ë‘ì‚¬ë¥¼ ì…ë ¥í•˜ì„¸ìš”.")
            return
        
        # í™•ì¸ ë©”ì‹œì§€
        if not messagebox.askyesno("í™•ì¸", 
                                  f"{len(self.files)}ê°œ íŒŒì¼ì˜ ì´ë¦„ì„ ë³€ê²½í•˜ì‹œê² ìŠµë‹ˆê¹Œ?"):
            return
        
        success_count = 0
        errors = []
        
        for file_path in self.files[:]:
            try:
                directory = os.path.dirname(file_path)
                old_name = os.path.basename(file_path)
                name, ext = os.path.splitext(old_name)
                new_name = f"{prefix}{name}{ext}"
                new_path = os.path.join(directory, new_name)
                
                if old_name == new_name:
                    continue  # ë³€ê²½í•  í•„ìš” ì—†ìŒ
                
                if os.path.exists(new_path):
                    errors.append(f"{old_name}: ëŒ€ìƒ íŒŒì¼ì´ ì´ë¯¸ ì¡´ì¬")
                    continue
                
                os.rename(file_path, new_path)
                # ëª©ë¡ì—ì„œ ê²½ë¡œ ì—…ë°ì´íŠ¸
                index = self.files.index(file_path)
                self.files[index] = new_path
                success_count += 1
                
            except Exception as e:
                errors.append(f"{os.path.basename(file_path)}: {str(e)}")
        
        # ê²°ê³¼ ë³´ê³ 
        result_msg = f"ì„±ê³µ: {success_count}ê°œ íŒŒì¼ ë³€ê²½ë¨"
        if errors:
            result_msg += f"\nì‹¤íŒ¨: {len(errors)}ê°œ"
            if len(errors) <= 5:  # ì˜¤ë¥˜ê°€ ì ìœ¼ë©´ ëª¨ë‘ í‘œì‹œ
                result_msg += "\n" + "\n".join(errors)
        
        messagebox.showinfo("ì‘ì—… ì™„ë£Œ", result_msg)
        self.update_file_list()
    
    def clear_files(self):
        """íŒŒì¼ ëª©ë¡ ì´ˆê¸°í™”"""
        self.files.clear()
        self.update_file_list()
        self.prefix_var.set("")
    
    def run(self):
        self.root.mainloop()

if __name__ == "__main__":
    app = BasicFileRenamer()
    app.run()
```

### ì‹¤í–‰ ê²°ê³¼

![Step 1 ê²°ê³¼](images/ch4_step1.png)

ì´ ë‹¨ê³„ì—ì„œëŠ” Chapter 3ì˜ í•µì‹¬ ë¡œì§ì„ ê·¸ëŒ€ë¡œ ìœ ì§€í•˜ë©´ì„œ GUI ì¸í„°í˜ì´ìŠ¤ë§Œ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤. ì‚¬ìš©ìëŠ” ì´ì œ ì½˜ì†” ëŒ€ì‹  ìœˆë„ìš°ë¥¼ í†µí•´ íŒŒì¼ì„ ì„ íƒí•˜ê³  ë¯¸ë¦¬ë³´ê¸°ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ğŸ’¡ Step 1ì—ì„œ ë°°ìš´ GUI ì„¤ê³„ ì›ì¹™

1. **ì ì§„ì  ì „í™˜**: ê¸°ì¡´ ë¡œì§ì„ ìœ ì§€í•˜ë©° ì¸í„°í˜ì´ìŠ¤ë§Œ ë³€ê²½
2. **ì‚¬ìš©ì ì¹œí™”ì  í”¼ë“œë°±**: ë¯¸ë¦¬ë³´ê¸° ì°½ìœ¼ë¡œ ì•ˆì „ì„± í™•ë³´
3. **ì§ê´€ì  íë¦„**: íŒŒì¼ ì„ íƒ â†’ ì˜µì…˜ ì„¤ì • â†’ ë¯¸ë¦¬ë³´ê¸° â†’ ì‹¤í–‰
4. **ì—ëŸ¬ ì²˜ë¦¬**: GUI í™˜ê²½ì— ë§ëŠ” messagebox í™œìš©

---

## ğŸ¨ Step 2: íŒŒì¼ ë‹¤ì´ì–¼ë¡œê·¸ ê°œì„ ê³¼ UI í–¥ìƒ

### ëª©í‘œ
Step 1ì˜ ê¸°ë³¸ GUIë¥¼ ê°œì„ í•˜ì—¬ ë” ë‚˜ì€ ì‚¬ìš©ì ê²½í—˜ì„ ì œê³µí•©ë‹ˆë‹¤. ì ‘ë¯¸ì‚¬ ì˜µì…˜ ì¶”ê°€, ë” ë‚˜ì€ íŒŒì¼ í‘œì‹œ, ìƒíƒœ ì •ë³´ ì œê³µ ë“±ì„ êµ¬í˜„í•©ë‹ˆë‹¤.

### step2_improved_ui.py

```python
import tkinter as tk
from tkinter import ttk, filedialog, messagebox
import os
from datetime import datetime

class ImprovedFileRenamer:
    def __init__(self):
        self.root = tk.Tk()
        self.root.title("íŒŒì¼ ë¦¬ë„¤ì´ë¨¸ v2.0 - í–¥ìƒëœ UI")
        self.root.geometry("700x500")
        
        self.files = []
        self.create_widgets()
        
        # ì‹¤ì‹œê°„ ë¯¸ë¦¬ë³´ê¸°ë¥¼ ìœ„í•œ ì´ë²¤íŠ¸ ë°”ì¸ë”©
        self.prefix_var.trace('w', self.on_option_change)
        self.suffix_var.trace('w', self.on_option_change)
    
    def create_widgets(self):
        # ë©”ì¸ í”„ë ˆì„
        main_frame = ttk.Frame(self.root, padding="10")
        main_frame.grid(row=0, column=0, sticky="nsew")
        
        # ì œëª©ê³¼ ìƒíƒœ ì •ë³´
        title_frame = ttk.Frame(main_frame)
        title_frame.grid(row=0, column=0, columnspan=2, sticky="ew", pady=(0, 10))
        
        ttk.Label(title_frame, text="íŒŒì¼ ì´ë¦„ ë³€ê²½ ë„êµ¬", 
                 font=("ë§‘ì€ ê³ ë”•", 16, "bold")).pack(side="left")
        
        # í˜„ì¬ ì‹œê°„ í‘œì‹œ
        self.time_var = tk.StringVar()
        self.update_time()
        ttk.Label(title_frame, textvariable=self.time_var, 
                 font=("ë§‘ì€ ê³ ë”•", 9)).pack(side="right")
        
        # íŒŒì¼ ê´€ë¦¬ í”„ë ˆì„
        file_frame = ttk.LabelFrame(main_frame, text="íŒŒì¼ ê´€ë¦¬", padding="5")
        file_frame.grid(row=1, column=0, columnspan=2, sticky="ew", pady=(0, 10))
        
        # íŒŒì¼ ì¶”ê°€/ì œê±° ë²„íŠ¼ë“¤
        btn_frame = ttk.Frame(file_frame)
        btn_frame.pack(fill="x", pady=(0, 5))
        
        ttk.Button(btn_frame, text="ğŸ“ íŒŒì¼ ì¶”ê°€", 
                  command=self.select_files).pack(side="left", padx=(0, 5))
        ttk.Button(btn_frame, text="ğŸ“‚ í´ë” ì¶”ê°€", 
                  command=self.select_folder).pack(side="left", padx=(0, 5))
        ttk.Button(btn_frame, text="ğŸ—‘ï¸ ì „ì²´ ì‚­ì œ", 
                  command=self.clear_files).pack(side="left", padx=(0, 5))
        ttk.Button(btn_frame, text="âŒ ì„ íƒ ì‚­ì œ", 
                  command=self.remove_selected).pack(side="left")
        
        # íŒŒì¼ ê°œìˆ˜ ì •ë³´
        self.file_count_var = tk.StringVar(value="íŒŒì¼ ê°œìˆ˜: 0")
        ttk.Label(btn_frame, textvariable=self.file_count_var).pack(side="right")
        
        # íŒŒì¼ ëª©ë¡ (Treeview ì‚¬ìš©)
        tree_frame = ttk.Frame(file_frame)
        tree_frame.pack(fill="both", expand=True)
        
        # Treeview ìƒì„±
        columns = ("íŒŒì¼ëª…", "ê²½ë¡œ", "í¬ê¸°")
        self.file_tree = ttk.Treeview(tree_frame, columns=columns, show="headings", height=8)
        
        # ì»¬ëŸ¼ ì„¤ì •
        self.file_tree.heading("íŒŒì¼ëª…", text="íŒŒì¼ëª…")
        self.file_tree.heading("ê²½ë¡œ", text="ê²½ë¡œ")
        self.file_tree.heading("í¬ê¸°", text="í¬ê¸°")
        
        self.file_tree.column("íŒŒì¼ëª…", width=200)
        self.file_tree.column("ê²½ë¡œ", width=300)
        self.file_tree.column("í¬ê¸°", width=80)
        
        # ìŠ¤í¬ë¡¤ë°”
        tree_scroll = ttk.Scrollbar(tree_frame, orient="vertical", command=self.file_tree.yview)
        self.file_tree.configure(yscrollcommand=tree_scroll.set)
        
        self.file_tree.pack(side="left", fill="both", expand=True)
        tree_scroll.pack(side="right", fill="y")
        
        # ì˜µì…˜ í”„ë ˆì„
        option_frame = ttk.LabelFrame(main_frame, text="ì´ë¦„ ë³€ê²½ ì˜µì…˜", padding="10")
        option_frame.grid(row=2, column=0, columnspan=2, sticky="ew", pady=(0, 10))
        
        # ì ‘ë‘ì‚¬
        ttk.Label(option_frame, text="ì ‘ë‘ì‚¬:").grid(row=0, column=0, sticky="w", padx=(0, 5))
        self.prefix_var = tk.StringVar()
        ttk.Entry(option_frame, textvariable=self.prefix_var, width=30).grid(row=0, column=1, sticky="w", padx=(0, 20))
        
        # ì ‘ë¯¸ì‚¬  
        ttk.Label(option_frame, text="ì ‘ë¯¸ì‚¬:").grid(row=0, column=2, sticky="w", padx=(0, 5))
        self.suffix_var = tk.StringVar()
        ttk.Entry(option_frame, textvariable=self.suffix_var, width=30).grid(row=0, column=3, sticky="w")
        
        # ë¯¸ë¦¬ë³´ê¸° í”„ë ˆì„
        preview_frame = ttk.LabelFrame(main_frame, text="ë¯¸ë¦¬ë³´ê¸°", padding="5")
        preview_frame.grid(row=3, column=0, columnspan=2, sticky="ew", pady=(0, 10))
        
        # ë¯¸ë¦¬ë³´ê¸° í…ìŠ¤íŠ¸
        self.preview_text = tk.Text(preview_frame, height=6, wrap="none")
        preview_scroll = ttk.Scrollbar(preview_frame, orient="vertical", command=self.preview_text.yview)
        self.preview_text.configure(yscrollcommand=preview_scroll.set)
        
        self.preview_text.pack(side="left", fill="both", expand=True)
        preview_scroll.pack(side="right", fill="y")
        
        # ì‹¤í–‰ ë²„íŠ¼ í”„ë ˆì„
        exec_frame = ttk.Frame(main_frame)
        exec_frame.grid(row=4, column=0, columnspan=2, pady=(10, 0))
        
        ttk.Button(exec_frame, text="ğŸ”„ ë¯¸ë¦¬ë³´ê¸° ìƒˆë¡œê³ ì¹¨", 
                  command=self.update_preview).pack(side="left", padx=(0, 10))
        ttk.Button(exec_frame, text="âœ… ì´ë¦„ ë³€ê²½ ì‹¤í–‰", 
                  command=self.execute_rename).pack(side="right")
        
        # ê·¸ë¦¬ë“œ ê°€ì¤‘ì¹˜ ì„¤ì •
        self.root.grid_rowconfigure(0, weight=1)
        self.root.grid_columnconfigure(0, weight=1)
        main_frame.grid_rowconfigure(1, weight=1)
        main_frame.grid_columnconfigure(1, weight=1)
    
    def update_time(self):
        """í˜„ì¬ ì‹œê°„ ì—…ë°ì´íŠ¸"""
        current_time = datetime.now().strftime("%Y-%m-%d %H:%M:%S")
        self.time_var.set(current_time)
        self.root.after(1000, self.update_time)  # 1ì´ˆë§ˆë‹¤ ì—…ë°ì´íŠ¸
    
    def select_files(self):
        """ê°œë³„ íŒŒì¼ ì„ íƒ"""
        files = filedialog.askopenfilenames(
            title="ì´ë¦„ì„ ë³€ê²½í•  íŒŒì¼ë“¤ì„ ì„ íƒí•˜ì„¸ìš”",
            filetypes=[("ëª¨ë“  íŒŒì¼", "*.*"), ("ì´ë¯¸ì§€ íŒŒì¼", "*.jpg;*.png;*.gif"), 
                      ("ë¬¸ì„œ íŒŒì¼", "*.txt;*.doc;*.pdf")]
        )
        
        for file_path in files:
            if file_path not in self.files:
                self.files.append(file_path)
        
        self.update_file_display()
    
    def select_folder(self):
        """í´ë” ë‚´ ëª¨ë“  íŒŒì¼ ì„ íƒ"""
        folder_path = filedialog.askdirectory(title="í´ë”ë¥¼ ì„ íƒí•˜ì„¸ìš”")
        if not folder_path:
            return
        
        try:
            for item in os.listdir(folder_path):
                file_path = os.path.join(folder_path, item)
                if os.path.isfile(file_path) and file_path not in self.files:
                    self.files.append(file_path)
            
            self.update_file_display()
            messagebox.showinfo("ì™„ë£Œ", f"{folder_path}ì˜ íŒŒì¼ë“¤ì„ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤.")
            
        except Exception as e:
            messagebox.showerror("ì˜¤ë¥˜", f"í´ë” ì½ê¸° ì‹¤íŒ¨: {str(e)}")
    
    def update_file_display(self):
        """íŒŒì¼ ëª©ë¡ í™”ë©´ ì—…ë°ì´íŠ¸"""
        # ê¸°ì¡´ í•­ëª© ì‚­ì œ
        for item in self.file_tree.get_children():
            self.file_tree.delete(item)
        
        # ìƒˆ íŒŒì¼ ëª©ë¡ ì¶”ê°€
        for file_path in self.files:
            filename = os.path.basename(file_path)
            directory = os.path.dirname(file_path)
            
            # íŒŒì¼ í¬ê¸° ê³„ì‚°
            try:
                size = os.path.getsize(file_path)
                if size < 1024:
                    size_str = f"{size} B"
                elif size < 1024*1024:
                    size_str = f"{size/1024:.1f} KB"
                else:
                    size_str = f"{size/(1024*1024):.1f} MB"
            except:
                size_str = "?"
            
            self.file_tree.insert("", "end", values=(filename, directory, size_str))
        
        # íŒŒì¼ ê°œìˆ˜ ì—…ë°ì´íŠ¸
        self.file_count_var.set(f"íŒŒì¼ ê°œìˆ˜: {len(self.files)}")
        
        # ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸
        self.update_preview()
    
    def remove_selected(self):
        """ì„ íƒëœ íŒŒì¼ ì œê±°"""
        selected_items = self.file_tree.selection()
        if not selected_items:
            messagebox.showwarning("ê²½ê³ ", "ì œê±°í•  íŒŒì¼ì„ ì„ íƒí•˜ì„¸ìš”.")
            return
        
        for item in selected_items:
            values = self.file_tree.item(item)['values']
            filename = values[0]
            directory = values[1]
            file_path = os.path.join(directory, filename)
            
            if file_path in self.files:
                self.files.remove(file_path)
        
        self.update_file_display()
    
    def clear_files(self):
        """ëª¨ë“  íŒŒì¼ ì œê±°"""
        self.files.clear()
        self.update_file_display()
        self.prefix_var.set("")
        self.suffix_var.set("")
    
    def on_option_change(self, *args):
        """ì˜µì…˜ ë³€ê²½ ì‹œ ìë™ ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸"""
        self.update_preview()
    
    def update_preview(self):
        """ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸"""
        self.preview_text.delete("1.0", tk.END)
        
        if not self.files:
            self.preview_text.insert("1.0", "íŒŒì¼ì´ ì„ íƒë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.")
            return
        
        prefix = self.prefix_var.get()
        suffix = self.suffix_var.get()
        
        if not prefix and not suffix:
            self.preview_text.insert("1.0", "ì ‘ë‘ì‚¬ë‚˜ ì ‘ë¯¸ì‚¬ë¥¼ ì…ë ¥í•˜ì„¸ìš”.")
            return
        
        preview_content = "ë³€ê²½ ë¯¸ë¦¬ë³´ê¸°:\n" + "="*60 + "\n"
        
        for file_path in self.files:
            old_name = os.path.basename(file_path)
            name, ext = os.path.splitext(old_name)
            new_name = f"{prefix}{name}{suffix}{ext}"
            
            preview_content += f"{old_name:30} â†’ {new_name}\n"
        
        self.preview_text.insert("1.0", preview_content)
    
    def execute_rename(self):
        """ì´ë¦„ ë³€ê²½ ì‹¤í–‰"""
        if not self.files:
            messagebox.showwarning("ê²½ê³ ", "ì„ íƒëœ íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.")
            return
        
        prefix = self.prefix_var.get()
        suffix = self.suffix_var.get()
        
        if not prefix and not suffix:
            messagebox.showwarning("ê²½ê³ ", "ì ‘ë‘ì‚¬ë‚˜ ì ‘ë¯¸ì‚¬ë¥¼ ì…ë ¥í•˜ì„¸ìš”.")
            return
        
        # í™•ì¸ ë©”ì‹œì§€
        if not messagebox.askyesno("í™•ì¸", 
                                  f"{len(self.files)}ê°œ íŒŒì¼ì˜ ì´ë¦„ì„ ë³€ê²½í•˜ì‹œê² ìŠµë‹ˆê¹Œ?"):
            return
        
        success_count = 0
        errors = []
        
        for file_path in self.files[:]:
            try:
                directory = os.path.dirname(file_path)
                old_name = os.path.basename(file_path)
                name, ext = os.path.splitext(old_name)
                new_name = f"{prefix}{name}{suffix}{ext}"
                new_path = os.path.join(directory, new_name)
                
                if old_name == new_name:
                    continue
                
                if os.path.exists(new_path):
                    errors.append(f"{old_name}: ëŒ€ìƒ íŒŒì¼ì´ ì´ë¯¸ ì¡´ì¬")
                    continue
                
                os.rename(file_path, new_path)
                index = self.files.index(file_path)
                self.files[index] = new_path
                success_count += 1
                
            except Exception as e:
                errors.append(f"{os.path.basename(file_path)}: {str(e)}")
        
        # ê²°ê³¼ ë³´ê³ 
        result_msg = f"âœ… ì„±ê³µ: {success_count}ê°œ íŒŒì¼ ë³€ê²½ë¨"
        if errors:
            result_msg += f"\nâŒ ì‹¤íŒ¨: {len(errors)}ê°œ"
            if len(errors) <= 5:
                result_msg += "\n\nì„¸ë¶€ ì˜¤ë¥˜:\n" + "\n".join(errors)
        
        messagebox.showinfo("ì‘ì—… ì™„ë£Œ", result_msg)
        self.update_file_display()
    
    def run(self):
        self.root.mainloop()

if __name__ == "__main__":
    app = ImprovedFileRenamer()
    app.run()
```

### ì‹¤í–‰ ê²°ê³¼

![Step 2 ê²°ê³¼](images/ch4_step2.png)

Step 2ì—ì„œëŠ” ì‚¬ìš©ì ê²½í—˜ì„ í¬ê²Œ ê°œì„ í–ˆìŠµë‹ˆë‹¤:

- **ì ‘ë¯¸ì‚¬ ì˜µì…˜ ì¶”ê°€**<!-- -->ë¡œ ë” ìœ ì—°í•œ ì´ë¦„ ë³€ê²½
- **Treeview**<!-- -->ë¡œ íŒŒì¼ ì •ë³´ë¥¼ ë” ìì„¸íˆ í‘œì‹œ
- **í´ë” ì„ íƒ**<!-- --> ê¸°ëŠ¥ìœ¼ë¡œ ëŒ€ëŸ‰ íŒŒì¼ ì²˜ë¦¬ ì§€ì›
- **ì‹¤ì‹œê°„ ë¯¸ë¦¬ë³´ê¸°**<!-- -->ë¡œ ì¦‰ì‹œ í”¼ë“œë°± ì œê³µ
- **íŒŒì¼ ê°œë³„ ì‚­ì œ**<!-- --> ê¸°ëŠ¥ìœ¼ë¡œ ì •ë°€í•œ ì œì–´

### ğŸ’¡ Step 2ì—ì„œ ë°°ìš´ UI/UX ì›ì¹™

1. **ì •ë³´ í‘œì‹œì˜ ì¶©ì‹¤ì„±**: íŒŒì¼ í¬ê¸°, ê²½ë¡œ ë“± ìƒì„¸ ì •ë³´ ì œê³µ
2. **ì‹¤ì‹œê°„ í”¼ë“œë°±**: ì˜µì…˜ ë³€ê²½ ì‹œ ì¦‰ì‹œ ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸  
3. **ì¼ê´„ ì²˜ë¦¬**: í´ë” ì„ íƒìœ¼ë¡œ ëŒ€ëŸ‰ íŒŒì¼ ì²˜ë¦¬ ì§€ì›
4. **ì„¸ë°€í•œ ì œì–´**: ê°œë³„ íŒŒì¼ ì„ íƒ/í•´ì œ ê¸°ëŠ¥

---

## ğŸ¯ Step 3: ë“œë˜ê·¸ ì•¤ ë“œë¡­ìœ¼ë¡œ ì§ê´€ì„± í™•ë³´

### ëª©í‘œ
tkinterdnd2 ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í™œìš©í•˜ì—¬ ë“œë˜ê·¸ ì•¤ ë“œë¡­ ê¸°ëŠ¥ì„ ì¶”ê°€í•˜ê³ , ì‚¬ìš©ìê°€ íŒŒì¼ì„ ë” ì§ê´€ì ìœ¼ë¡œ ì¶”ê°€í•  ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤.

### step3_drag_drop.py

```python
import tkinter as tk
from tkinter import ttk, filedialog, messagebox
import os

# ë“œë˜ê·¸ ì•¤ ë“œë¡­ ë¼ì´ë¸ŒëŸ¬ë¦¬ (ì„ íƒì )
try:
    from tkinterdnd2 import DND_FILES, TkinterDnD
    DND_AVAILABLE = True
except ImportError:
    DND_AVAILABLE = False
    print("tkinterdnd2ê°€ ì„¤ì¹˜ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. íŒŒì¼ ë‹¤ì´ì–¼ë¡œê·¸ë§Œ ì‚¬ìš©ë©ë‹ˆë‹¤.")

class DragDropFileRenamer:
    def __init__(self):
        # ë“œë˜ê·¸ ì•¤ ë“œë¡­ ì§€ì› ì—¬ë¶€ì— ë”°ë¼ ë‹¤ë¥¸ ë°©ì‹ìœ¼ë¡œ ìœˆë„ìš° ìƒì„±
        if DND_AVAILABLE:
            self.root = TkinterDnD.Tk()
        else:
            self.root = tk.Tk()
        
        self.root.title("íŒŒì¼ ë¦¬ë„¤ì´ë¨¸ v3.0 - ë“œë˜ê·¸ ì•¤ ë“œë¡­")
        self.root.geometry("750x600")
        
        self.files = []
        self.create_widgets()
        self.setup_drag_drop()
        
        # ì‹¤ì‹œê°„ ë¯¸ë¦¬ë³´ê¸°
        self.prefix_var.trace('w', self.on_option_change)
        self.suffix_var.trace('w', self.on_option_change)
    
    def create_widgets(self):
        # ë©”ì¸ í”„ë ˆì„
        main_frame = ttk.Frame(self.root, padding="10")
        main_frame.grid(row=0, column=0, sticky="nsew")
        
        # ì œëª©
        title_label = ttk.Label(main_frame, text="íŒŒì¼ ì´ë¦„ ë³€ê²½ ë„êµ¬ (ë“œë˜ê·¸ ì•¤ ë“œë¡­)", 
                               font=("ë§‘ì€ ê³ ë”•", 16, "bold"))
        title_label.grid(row=0, column=0, columnspan=2, pady=(0, 15))
        
        # ë“œë˜ê·¸ ì•¤ ë“œë¡­ ì˜ì—­
        self.drop_frame = ttk.LabelFrame(main_frame, text="íŒŒì¼ ì¶”ê°€", padding="10")
        self.drop_frame.grid(row=1, column=0, columnspan=2, sticky="ew", pady=(0, 10))
        
        # ë“œë¡­ ë¼ë²¨ (ì‹œê°ì  ë“œë¡­ ì˜ì—­)
        if DND_AVAILABLE:
            drop_text = "ğŸ“ íŒŒì¼ì„ ì—¬ê¸°ì— ë“œë˜ê·¸ ì•¤ ë“œë¡­í•˜ê±°ë‚˜ ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”"
            bg_color = "#e8f4fd"  # ì—°í•œ íŒŒë€ìƒ‰
        else:
            drop_text = "âš ï¸ ë“œë˜ê·¸ ì•¤ ë“œë¡­ ë¶ˆê°€ëŠ¥ - ë²„íŠ¼ì„ ì‚¬ìš©í•˜ì„¸ìš”"
            bg_color = "#fff2cc"  # ì—°í•œ ë…¸ë€ìƒ‰
        
        self.drop_label = tk.Label(
            self.drop_frame, 
            text=drop_text,
            font=("ë§‘ì€ ê³ ë”•", 12),
            bg=bg_color,
            relief="ridge",
            bd=2,
            height=3
        )
        self.drop_label.pack(fill="x", pady=(0, 10))
        
        # íŒŒì¼ ì¶”ê°€ ë²„íŠ¼ë“¤
        btn_frame = ttk.Frame(self.drop_frame)
        btn_frame.pack(fill="x")
        
        ttk.Button(btn_frame, text="ğŸ“„ íŒŒì¼ ì„ íƒ", 
                  command=self.select_files).pack(side="left", padx=(0, 5))
        ttk.Button(btn_frame, text="ğŸ“‚ í´ë” ì„ íƒ", 
                  command=self.select_folder).pack(side="left", padx=(0, 5))
        
        # íŒŒì¼ ëª©ë¡ ì˜ì—­
        list_frame = ttk.LabelFrame(main_frame, text="íŒŒì¼ ëª©ë¡", padding="5")
        list_frame.grid(row=2, column=0, columnspan=2, sticky="nsew", pady=(0, 10))
        
        # íŒŒì¼ ê°œìˆ˜ì™€ ì œì–´ ë²„íŠ¼
        control_frame = ttk.Frame(list_frame)
        control_frame.pack(fill="x", pady=(0, 5))
        
        self.file_count_var = tk.StringVar(value="íŒŒì¼ ê°œìˆ˜: 0")
        ttk.Label(control_frame, textvariable=self.file_count_var).pack(side="left")
        
        ttk.Button(control_frame, text="ğŸ—‘ï¸ ì „ì²´ ì‚­ì œ", 
                  command=self.clear_files).pack(side="right", padx=(5, 0))
        ttk.Button(control_frame, text="âŒ ì„ íƒ ì‚­ì œ", 
                  command=self.remove_selected).pack(side="right")
        
        # íŒŒì¼ ëª©ë¡ (Treeview)
        columns = ("#", "íŒŒì¼ëª…", "ê²½ë¡œ", "í¬ê¸°")
        self.file_tree = ttk.Treeview(list_frame, columns=columns, show="headings", height=10)
        
        self.file_tree.heading("#", text="#")
        self.file_tree.heading("íŒŒì¼ëª…", text="íŒŒì¼ëª…")
        self.file_tree.heading("ê²½ë¡œ", text="ê²½ë¡œ")  
        self.file_tree.heading("í¬ê¸°", text="í¬ê¸°")
        
        self.file_tree.column("#", width=40)
        self.file_tree.column("íŒŒì¼ëª…", width=200)
        self.file_tree.column("ê²½ë¡œ", width=300)
        self.file_tree.column("í¬ê¸°", width=80)
        
        # ìŠ¤í¬ë¡¤ë°”
        tree_scroll = ttk.Scrollbar(list_frame, orient="vertical", command=self.file_tree.yview)
        self.file_tree.configure(yscrollcommand=tree_scroll.set)
        
        self.file_tree.pack(side="left", fill="both", expand=True)
        tree_scroll.pack(side="right", fill="y")
        
        # ì˜µì…˜ í”„ë ˆì„
        option_frame = ttk.LabelFrame(main_frame, text="ì´ë¦„ ë³€ê²½ ì˜µì…˜", padding="10")
        option_frame.grid(row=3, column=0, columnspan=2, sticky="ew", pady=(0, 10))
        
        # ì ‘ë‘ì‚¬
        ttk.Label(option_frame, text="ì ‘ë‘ì‚¬:").grid(row=0, column=0, sticky="w", padx=(0, 5))
        self.prefix_var = tk.StringVar()
        ttk.Entry(option_frame, textvariable=self.prefix_var, width=30).grid(row=0, column=1, sticky="w", padx=(0, 20))
        
        # ì ‘ë¯¸ì‚¬
        ttk.Label(option_frame, text="ì ‘ë¯¸ì‚¬:").grid(row=0, column=2, sticky="w", padx=(0, 5))
        self.suffix_var = tk.StringVar()
        ttk.Entry(option_frame, textvariable=self.suffix_var, width=30).grid(row=0, column=3, sticky="w")
        
        # ë¯¸ë¦¬ë³´ê¸° í”„ë ˆì„
        preview_frame = ttk.LabelFrame(main_frame, text="ë¯¸ë¦¬ë³´ê¸°", padding="5")
        preview_frame.grid(row=4, column=0, columnspan=2, sticky="ew", pady=(0, 10))
        
        self.preview_text = tk.Text(preview_frame, height=5, wrap="none")
        preview_scroll = ttk.Scrollbar(preview_frame, orient="vertical", command=self.preview_text.yview)
        self.preview_text.configure(yscrollcommand=preview_scroll.set)
        
        self.preview_text.pack(side="left", fill="both", expand=True)
        preview_scroll.pack(side="right", fill="y")
        
        # ì‹¤í–‰ ë²„íŠ¼
        exec_frame = ttk.Frame(main_frame)
        exec_frame.grid(row=5, column=0, columnspan=2, pady=(10, 0))
        
        ttk.Button(exec_frame, text="âœ… ì´ë¦„ ë³€ê²½ ì‹¤í–‰", 
                  command=self.execute_rename, 
                  style="Accent.TButton").pack(side="right")
        
        # ê·¸ë¦¬ë“œ ê°€ì¤‘ì¹˜ ì„¤ì •
        self.root.grid_rowconfigure(0, weight=1)
        self.root.grid_columnconfigure(0, weight=1)
        main_frame.grid_rowconfigure(2, weight=1)
        main_frame.grid_columnconfigure(1, weight=1)
    
    def setup_drag_drop(self):
        """ë“œë˜ê·¸ ì•¤ ë“œë¡­ ì„¤ì •"""
        if not DND_AVAILABLE:
            return
        
        # ë“œë¡­ ë¼ë²¨ì— ë“œë˜ê·¸ ì•¤ ë“œë¡­ ì´ë²¤íŠ¸ ë°”ì¸ë”©
        self.drop_label.drop_target_register(DND_FILES)
        self.drop_label.dnd_bind('<<Drop>>', self.on_file_drop)
        self.drop_label.dnd_bind('<<DragEnter>>', self.on_drag_enter)
        self.drop_label.dnd_bind('<<DragLeave>>', self.on_drag_leave)
        
        # ë©”ì¸ í”„ë ˆì„ì—ë„ ë“œë¡­ ê¸°ëŠ¥ ì¶”ê°€ (í¸ì˜ì„±)
        self.drop_frame.drop_target_register(DND_FILES)
        self.drop_frame.dnd_bind('<<Drop>>', self.on_file_drop)
    
    def on_drag_enter(self, event):
        """ë“œë˜ê·¸ ì§„ì… ì‹œ ì‹œê°ì  í”¼ë“œë°±"""
        self.drop_label.configure(bg="#d4e6f1")  # ë” ì§„í•œ íŒŒë€ìƒ‰
        self.drop_label.configure(text="ğŸ“¥ íŒŒì¼ì„ ë†“ìœ¼ì„¸ìš”!")
    
    def on_drag_leave(self, event):
        """ë“œë˜ê·¸ ë²—ì–´ë‚  ë•Œ ì›ë˜ ìƒíƒœë¡œ"""
        self.drop_label.configure(bg="#e8f4fd")  # ì›ë˜ ìƒ‰ìƒ
        self.drop_label.configure(text="ğŸ“ íŒŒì¼ì„ ì—¬ê¸°ì— ë“œë˜ê·¸ ì•¤ ë“œë¡­í•˜ê±°ë‚˜ ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”")
    
    def on_file_drop(self, event):
        """íŒŒì¼ ë“œë¡­ ì´ë²¤íŠ¸ ì²˜ë¦¬"""
        # ë“œë¡­ëœ íŒŒì¼ ê²½ë¡œë“¤ íŒŒì‹±
        files = self.parse_drop_files(event.data)
        
        added_count = 0
        for file_path in files:
            if os.path.isfile(file_path) and file_path not in self.files:
                self.files.append(file_path)
                added_count += 1
        
        if added_count > 0:
            self.update_file_display()
            # ê°„ë‹¨í•œ ì„±ê³µ í”¼ë“œë°±
            self.drop_label.configure(text=f"âœ… {added_count}ê°œ íŒŒì¼ ì¶”ê°€ë¨!")
            self.root.after(2000, lambda: self.drop_label.configure(
                text="ğŸ“ íŒŒì¼ì„ ì—¬ê¸°ì— ë“œë˜ê·¸ ì•¤ ë“œë¡­í•˜ê±°ë‚˜ ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”"))
        else:
            self.drop_label.configure(text="âŒ ìœ íš¨í•œ íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤")
            self.root.after(2000, lambda: self.drop_label.configure(
                text="ğŸ“ íŒŒì¼ì„ ì—¬ê¸°ì— ë“œë˜ê·¸ ì•¤ ë“œë¡­í•˜ê±°ë‚˜ ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”"))
    
    def parse_drop_files(self, data):
        """ë“œë¡­ëœ íŒŒì¼ ë°ì´í„° íŒŒì‹±"""
        # tkinterdnd2ëŠ” íŒŒì¼ ê²½ë¡œë¥¼ íŠ¹ë³„í•œ í˜•ì‹ìœ¼ë¡œ ì „ë‹¬
        files = []
        
        # ì¤‘ê´„í˜¸ë¡œ ê°ì‹¸ì§„ ê²½ë¡œ ì²˜ë¦¬
        if data.startswith('{') and data.endswith('}'):
            data = data[1:-1]
        
        # ê³µë°±ìœ¼ë¡œ êµ¬ë¶„ëœ ì—¬ëŸ¬ íŒŒì¼ ì²˜ë¦¬
        for item in data.split():
            item = item.strip()
            if item.startswith('{') and item.endswith('}'):
                item = item[1:-1]
            if os.path.exists(item):
                files.append(item)
        
        return files
    
    def select_files(self):
        """íŒŒì¼ ë‹¤ì´ì–¼ë¡œê·¸ë¡œ íŒŒì¼ ì„ íƒ"""
        files = filedialog.askopenfilenames(
            title="ì´ë¦„ì„ ë³€ê²½í•  íŒŒì¼ë“¤ì„ ì„ íƒí•˜ì„¸ìš”",
            filetypes=[("ëª¨ë“  íŒŒì¼", "*.*"), ("ì´ë¯¸ì§€ íŒŒì¼", "*.jpg;*.png;*.gif"), 
                      ("ë¬¸ì„œ íŒŒì¼", "*.txt;*.doc;*.pdf")]
        )
        
        for file_path in files:
            if file_path not in self.files:
                self.files.append(file_path)
        
        self.update_file_display()
    
    def select_folder(self):
        """í´ë” ë‚´ íŒŒì¼ë“¤ ì„ íƒ"""
        folder_path = filedialog.askdirectory(title="í´ë”ë¥¼ ì„ íƒí•˜ì„¸ìš”")
        if not folder_path:
            return
        
        try:
            added_count = 0
            for item in os.listdir(folder_path):
                file_path = os.path.join(folder_path, item)
                if os.path.isfile(file_path) and file_path not in self.files:
                    self.files.append(file_path)
                    added_count += 1
            
            if added_count > 0:
                self.update_file_display()
                messagebox.showinfo("ì™„ë£Œ", f"{added_count}ê°œ íŒŒì¼ì„ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤.")
            else:
                messagebox.showinfo("ì •ë³´", "ì¶”ê°€í•  ìƒˆ íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.")
                
        except Exception as e:
            messagebox.showerror("ì˜¤ë¥˜", f"í´ë” ì½ê¸° ì‹¤íŒ¨: {str(e)}")
    
    def update_file_display(self):
        """íŒŒì¼ ëª©ë¡ ì—…ë°ì´íŠ¸"""
        # ê¸°ì¡´ í•­ëª© ì‚­ì œ
        for item in self.file_tree.get_children():
            self.file_tree.delete(item)
        
        # íŒŒì¼ ëª©ë¡ ì¶”ê°€
        for i, file_path in enumerate(self.files, 1):
            filename = os.path.basename(file_path)
            directory = os.path.dirname(file_path)
            
            # íŒŒì¼ í¬ê¸° ê³„ì‚°
            try:
                size = os.path.getsize(file_path)
                if size < 1024:
                    size_str = f"{size} B"
                elif size < 1024*1024:
                    size_str = f"{size/1024:.1f} KB"
                else:
                    size_str = f"{size/(1024*1024):.1f} MB"
            except:
                size_str = "?"
            
            self.file_tree.insert("", "end", values=(i, filename, directory, size_str))
        
        # íŒŒì¼ ê°œìˆ˜ ì—…ë°ì´íŠ¸
        self.file_count_var.set(f"íŒŒì¼ ê°œìˆ˜: {len(self.files)}")
        
        # ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸
        self.update_preview()
    
    def remove_selected(self):
        """ì„ íƒëœ íŒŒì¼ ì œê±°"""
        selected_items = self.file_tree.selection()
        if not selected_items:
            messagebox.showwarning("ê²½ê³ ", "ì œê±°í•  íŒŒì¼ì„ ì„ íƒí•˜ì„¸ìš”.")
            return
        
        # ì„ íƒëœ í•­ëª©ë“¤ì˜ ì¸ë±ìŠ¤ ìˆ˜ì§‘ (ì—­ìˆœìœ¼ë¡œ ì •ë ¬)
        indices_to_remove = []
        for item in selected_items:
            values = self.file_tree.item(item)['values']
            index = int(values[0]) - 1  # 1-basedì—ì„œ 0-basedë¡œ ë³€í™˜
            indices_to_remove.append(index)
        
        # ì¸ë±ìŠ¤ ì—­ìˆœìœ¼ë¡œ ì •ë ¬í•´ì„œ ì œê±° (í° ì¸ë±ìŠ¤ë¶€í„°)
        for index in sorted(indices_to_remove, reverse=True):
            if 0 <= index < len(self.files):
                del self.files[index]
        
        self.update_file_display()
    
    def clear_files(self):
        """ëª¨ë“  íŒŒì¼ ì œê±°"""
        self.files.clear()
        self.update_file_display()
        self.prefix_var.set("")
        self.suffix_var.set("")
    
    def on_option_change(self, *args):
        """ì˜µì…˜ ë³€ê²½ ì‹œ ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸"""
        self.update_preview()
    
    def update_preview(self):
        """ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸"""
        self.preview_text.delete("1.0", tk.END)
        
        if not self.files:
            self.preview_text.insert("1.0", "íŒŒì¼ì´ ì„ íƒë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.")
            return
        
        prefix = self.prefix_var.get()
        suffix = self.suffix_var.get()
        
        if not prefix and not suffix:
            self.preview_text.insert("1.0", "ì ‘ë‘ì‚¬ë‚˜ ì ‘ë¯¸ì‚¬ë¥¼ ì…ë ¥í•˜ì„¸ìš”.")
            return
        
        preview_content = "ë³€ê²½ ë¯¸ë¦¬ë³´ê¸°:\n" + "="*60 + "\n"
        
        for file_path in self.files:
            old_name = os.path.basename(file_path)
            name, ext = os.path.splitext(old_name)
            new_name = f"{prefix}{name}{suffix}{ext}"
            
            preview_content += f"{old_name:30} â†’ {new_name}\n"
        
        self.preview_text.insert("1.0", preview_content)
    
    def execute_rename(self):
        """ì´ë¦„ ë³€ê²½ ì‹¤í–‰"""
        if not self.files:
            messagebox.showwarning("ê²½ê³ ", "ì„ íƒëœ íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.")
            return
        
        prefix = self.prefix_var.get()
        suffix = self.suffix_var.get()
        
        if not prefix and not suffix:
            messagebox.showwarning("ê²½ê³ ", "ì ‘ë‘ì‚¬ë‚˜ ì ‘ë¯¸ì‚¬ë¥¼ ì…ë ¥í•˜ì„¸ìš”.")
            return
        
        # í™•ì¸ ë©”ì‹œì§€
        if not messagebox.askyesno("í™•ì¸", 
                                  f"{len(self.files)}ê°œ íŒŒì¼ì˜ ì´ë¦„ì„ ë³€ê²½í•˜ì‹œê² ìŠµë‹ˆê¹Œ?"):
            return
        
        success_count = 0
        errors = []
        
        for file_path in self.files[:]:
            try:
                directory = os.path.dirname(file_path)
                old_name = os.path.basename(file_path)
                name, ext = os.path.splitext(old_name)
                new_name = f"{prefix}{name}{suffix}{ext}"
                new_path = os.path.join(directory, new_name)
                
                if old_name == new_name:
                    continue
                
                if os.path.exists(new_path):
                    errors.append(f"{old_name}: ëŒ€ìƒ íŒŒì¼ì´ ì´ë¯¸ ì¡´ì¬")
                    continue
                
                os.rename(file_path, new_path)
                index = self.files.index(file_path)
                self.files[index] = new_path
                success_count += 1
                
            except Exception as e:
                errors.append(f"{os.path.basename(file_path)}: {str(e)}")
        
        # ê²°ê³¼ ë³´ê³ 
        result_msg = f"âœ… ì„±ê³µ: {success_count}ê°œ íŒŒì¼ ë³€ê²½ë¨"
        if errors:
            result_msg += f"\nâŒ ì‹¤íŒ¨: {len(errors)}ê°œ"
            if len(errors) <= 5:
                result_msg += "\n\nì„¸ë¶€ ì˜¤ë¥˜:\n" + "\n".join(errors)
        
        messagebox.showinfo("ì‘ì—… ì™„ë£Œ", result_msg)
        self.update_file_display()
    
    def run(self):
        self.root.mainloop()

if __name__ == "__main__":
    app = DragDropFileRenamer()
    app.run()
```

### ì‹¤í–‰ ê²°ê³¼

![Step 3 ê²°ê³¼](images/ch4_step3.png)

Step 3ì—ì„œëŠ” ë“œë˜ê·¸ ì•¤ ë“œë¡­ ê¸°ëŠ¥ì„ ì™„ì „íˆ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤:

- **ì‹œê°ì  ë“œë¡­ ì˜ì—­**<!-- -->ìœ¼ë¡œ ëª…í™•í•œ ì‚¬ìš©ì ì•ˆë‚´
- **ë“œë˜ê·¸ ìƒíƒœ í”¼ë“œë°±**<!-- -->ìœ¼ë¡œ ì‹¤ì‹œê°„ ìƒí˜¸ì‘ìš©
- **ë‹¤ì–‘í•œ íŒŒì¼ ê²½ë¡œ í˜•ì‹**<!-- --> ì§€ì›
- **ë¼ì´ë¸ŒëŸ¬ë¦¬ ì—†ì´ë„ ì‘ë™**<!-- -->í•˜ëŠ” ëŒ€ì²´ ê¸°ëŠ¥

### ğŸ’¡ Step 3ì—ì„œ ë°°ìš´ ë“œë˜ê·¸ ì•¤ ë“œë¡­ ì„¤ê³„ ì›ì¹™

1. **ëª…í™•í•œ ë“œë¡­ ì˜ì—­**: ì‹œê°ì ìœ¼ë¡œ êµ¬ë¶„ë˜ëŠ” ë“œë¡­ êµ¬ì—­ ì œê³µ
2. **ì¦‰ì‹œ í”¼ë“œë°±**: ë“œë˜ê·¸ ì§„ì…/ë²—ì–´ë‚¨ ì‹œ ì‹œê°ì  ë³€í™”
3. **ì„±ê³µ/ì‹¤íŒ¨ ì•Œë¦¼**: ë“œë¡­ í›„ ê²°ê³¼ë¥¼ ì‚¬ìš©ìì—ê²Œ ëª…í™•íˆ ì „ë‹¬
4. **ëŒ€ì²´ ìˆ˜ë‹¨ ì œê³µ**: ë¼ì´ë¸ŒëŸ¬ë¦¬ ì—†ì–´ë„ ê¸°ë³¸ ê¸°ëŠ¥ ë³´ì¥

---

## ğŸ” Step 4: ì°¾ê¸°/ë°”ê¾¸ê¸° ê¸°ëŠ¥ìœ¼ë¡œ ìœ ì—°ì„± ì¶”ê°€

### ëª©í‘œ
Step 3ì˜ ê¸°ë³¸ ì ‘ë‘ì‚¬/ì ‘ë¯¸ì‚¬ ê¸°ëŠ¥ì„ í™•ì¥í•˜ì—¬ **ì°¾ê¸°/ë°”ê¾¸ê¸° ê¸°ëŠ¥**<!-- -->ê³¼ **ì •ê·œí‘œí˜„ì‹ ì§€ì›**<!-- -->ì„ ì¶”ê°€í•©ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ë”ìš± ìœ ì—°í•˜ê³  ê°•ë ¥í•œ íŒŒì¼ëª… ë³€ê²½ì´ ê°€ëŠ¥í•´ì§‘ë‹ˆë‹¤.

### step4_find_replace.py

```python linenums="1" title="src/chapter4/step4_find_replace.py"
import tkinter as tk
from tkinter import ttk, filedialog, messagebox
import os
import re

# ë“œë˜ê·¸ ì•¤ ë“œë¡­ ë¼ì´ë¸ŒëŸ¬ë¦¬ (ì„ íƒì )
try:
    from tkinterdnd2 import DND_FILES, TkinterDnD
    DND_AVAILABLE = True
except ImportError:
    DND_AVAILABLE = False

class FindReplaceFileRenamer:
    def __init__(self):
        # ë“œë˜ê·¸ ì•¤ ë“œë¡­ ì§€ì› ì—¬ë¶€ì— ë”°ë¼ ë‹¤ë¥¸ ë°©ì‹ìœ¼ë¡œ ìœˆë„ìš° ìƒì„±
        if DND_AVAILABLE:
            self.root = TkinterDnD.Tk()
        else:
            self.root = tk.Tk()
        
        self.root.title("íŒŒì¼ ë¦¬ë„¤ì´ë¨¸ v4.0 - ì°¾ê¸°/ë°”ê¾¸ê¸°")
        self.root.geometry("850x750")
        
        self.files = []
        self.create_widgets()
        self.setup_drag_drop()
        
        # ì‹¤ì‹œê°„ ë¯¸ë¦¬ë³´ê¸°
        self.setup_preview_bindings()
    
    def create_widgets(self):
        # ë©”ì¸ í”„ë ˆì„
        main_frame = ttk.Frame(self.root, padding="10")
        main_frame.grid(row=0, column=0, sticky="nsew")
        
        # ì œëª©
        title_label = ttk.Label(main_frame, text="íŒŒì¼ ì´ë¦„ ë³€ê²½ ë„êµ¬ - ì°¾ê¸°/ë°”ê¾¸ê¸°", 
                               font=("ë§‘ì€ ê³ ë”•", 16, "bold"))
        title_label.grid(row=0, column=0, columnspan=2, pady=(0, 15))
        
        # ë“œë˜ê·¸ ì•¤ ë“œë¡­ ì˜ì—­
        self.create_drop_area(main_frame)
        
        # íŒŒì¼ ëª©ë¡ ì˜ì—­
        self.create_file_list(main_frame)
        
        # ì´ë¦„ ë³€ê²½ ì˜µì…˜ ì˜ì—­
        self.create_rename_options(main_frame)
        
        # ë¯¸ë¦¬ë³´ê¸° ì˜ì—­
        self.create_preview_area(main_frame)
        
        # ì‹¤í–‰ ë²„íŠ¼
        self.create_action_buttons(main_frame)
        
        # ê·¸ë¦¬ë“œ ê°€ì¤‘ì¹˜ ì„¤ì •
        self.root.columnconfigure(0, weight=1)
        self.root.rowconfigure(0, weight=1)
        main_frame.columnconfigure(1, weight=1)
        main_frame.rowconfigure(2, weight=1)  # íŒŒì¼ ëª©ë¡
        main_frame.rowconfigure(4, weight=1)  # ë¯¸ë¦¬ë³´ê¸°
    
    def create_drop_area(self, parent):
        """ë“œë˜ê·¸ ì•¤ ë“œë¡­ ì˜ì—­ ìƒì„±"""
        drop_frame = ttk.LabelFrame(parent, text="íŒŒì¼ ì¶”ê°€", padding="10")
        drop_frame.grid(row=1, column=0, columnspan=2, sticky="ew", pady=(0, 10))
        
        # ë“œë¡­ ë¼ë²¨
        if DND_AVAILABLE:
            drop_text = "ğŸ“ íŒŒì¼ì„ ì—¬ê¸°ì— ë“œë˜ê·¸ ì•¤ ë“œë¡­í•˜ê±°ë‚˜ ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”"
            bg_color = "#e8f4fd"
        else:
            drop_text = "âš ï¸ ë“œë˜ê·¸ ì•¤ ë“œë¡­ ë¶ˆê°€ëŠ¥ - ë²„íŠ¼ì„ ì‚¬ìš©í•˜ì„¸ìš”"
            bg_color = "#fff2cc"
        
        self.drop_label = tk.Label(
            drop_frame, 
            text=drop_text,
            font=("ë§‘ì€ ê³ ë”•", 11),
            bg=bg_color,
            relief="ridge",
            bd=2,
            height=2
        )
        self.drop_label.pack(fill="x", pady=(0, 10))
        
        # íŒŒì¼ ì¶”ê°€ ë²„íŠ¼ë“¤
        btn_frame = ttk.Frame(drop_frame)
        btn_frame.pack(fill="x")
        
        ttk.Button(btn_frame, text="ğŸ“„ íŒŒì¼ ì„ íƒ", 
                  command=self.select_files).pack(side="left", padx=(0, 5))
        ttk.Button(btn_frame, text="ğŸ“‚ í´ë” ì„ íƒ", 
                  command=self.select_folder).pack(side="left", padx=(0, 5))
        ttk.Button(btn_frame, text="ğŸ—‘ï¸ ì „ì²´ ì‚­ì œ", 
                  command=self.clear_files).pack(side="right")
    
    def create_file_list(self, parent):
        """íŒŒì¼ ëª©ë¡ ì˜ì—­ ìƒì„±"""
        list_frame = ttk.LabelFrame(parent, text="íŒŒì¼ ëª©ë¡", padding="5")
        list_frame.grid(row=2, column=0, columnspan=2, sticky="nsew", pady=(0, 10))
        
        # íŒŒì¼ ê°œìˆ˜ í‘œì‹œ
        self.file_count_var = tk.StringVar(value="íŒŒì¼ ê°œìˆ˜: 0")
        ttk.Label(list_frame, textvariable=self.file_count_var).pack(anchor="w", pady=(0, 5))
        
        # íŒŒì¼ ëª©ë¡ (Treeview)
        columns = ("íŒŒì¼ëª…", "ê²½ë¡œ", "í¬ê¸°")
        self.file_tree = ttk.Treeview(list_frame, columns=columns, show="headings", height=8)
        
        self.file_tree.heading("íŒŒì¼ëª…", text="íŒŒì¼ëª…")
        self.file_tree.heading("ê²½ë¡œ", text="ê²½ë¡œ")  
        self.file_tree.heading("í¬ê¸°", text="í¬ê¸°")
        
        self.file_tree.column("íŒŒì¼ëª…", width=200)
        self.file_tree.column("ê²½ë¡œ", width=300)
        self.file_tree.column("í¬ê¸°", width=80)
        
        # ìŠ¤í¬ë¡¤ë°”
        scrollbar = ttk.Scrollbar(list_frame, orient="vertical", command=self.file_tree.yview)
        self.file_tree.configure(yscrollcommand=scrollbar.set)
        
        self.file_tree.pack(side="left", fill="both", expand=True)
        scrollbar.pack(side="right", fill="y")
        
        list_frame.columnconfigure(0, weight=1)
        list_frame.rowconfigure(1, weight=1)
    
    def create_rename_options(self, parent):
        """ì´ë¦„ ë³€ê²½ ì˜µì…˜ ì˜ì—­ ìƒì„±"""
        options_frame = ttk.LabelFrame(parent, text="ì´ë¦„ ë³€ê²½ ì˜µì…˜", padding="10")
        options_frame.grid(row=3, column=0, columnspan=2, sticky="ew", pady=(0, 10))
        
        # ì‘ì—… ëª¨ë“œ ì„ íƒ
        self.mode_var = tk.StringVar(value="prefix")
        
        mode_frame = ttk.Frame(options_frame)
        mode_frame.pack(fill="x", pady=(0, 10))
        
        ttk.Radiobutton(mode_frame, text="ì ‘ë‘ì‚¬ ì¶”ê°€", variable=self.mode_var, 
                       value="prefix").pack(side="left", padx=(0, 10))
        ttk.Radiobutton(mode_frame, text="ì ‘ë¯¸ì‚¬ ì¶”ê°€", variable=self.mode_var, 
                       value="suffix").pack(side="left", padx=(0, 10))
        ttk.Radiobutton(mode_frame, text="ì°¾ê¸°/ë°”ê¾¸ê¸°", variable=self.mode_var, 
                       value="find_replace").pack(side="left", padx=(0, 10))
        ttk.Radiobutton(mode_frame, text="ì—°ë²ˆ ë§¤ê¸°ê¸°", variable=self.mode_var, 
                       value="numbering").pack(side="left")
        
        # ì˜µì…˜ë³„ ì…ë ¥ ì˜ì—­
        self.create_option_inputs(options_frame)
    
    def create_option_inputs(self, parent):
        """ê° ëª¨ë“œë³„ ì…ë ¥ í•„ë“œ ìƒì„±"""
        input_frame = ttk.Frame(parent)
        input_frame.pack(fill="x")
        
        # ì ‘ë‘ì‚¬/ì ‘ë¯¸ì‚¬ ì…ë ¥
        prefix_suffix_frame = ttk.Frame(input_frame)
        prefix_suffix_frame.grid(row=0, column=0, sticky="ew", pady=2)
        
        ttk.Label(prefix_suffix_frame, text="í…ìŠ¤íŠ¸:").pack(side="left")
        self.text_var = tk.StringVar()
        self.text_entry = ttk.Entry(prefix_suffix_frame, textvariable=self.text_var, width=20)
        self.text_entry.pack(side="left", padx=(5, 0))
        
        # ì°¾ê¸°/ë°”ê¾¸ê¸° ì…ë ¥
        find_replace_frame = ttk.Frame(input_frame)
        find_replace_frame.grid(row=1, column=0, sticky="ew", pady=2)
        
        ttk.Label(find_replace_frame, text="ì°¾ê¸°:").pack(side="left")
        self.find_var = tk.StringVar()
        self.find_entry = ttk.Entry(find_replace_frame, textvariable=self.find_var, width=15)
        self.find_entry.pack(side="left", padx=(5, 10))
        
        ttk.Label(find_replace_frame, text="ë°”ê¾¸ê¸°:").pack(side="left")
        self.replace_var = tk.StringVar()
        self.replace_entry = ttk.Entry(find_replace_frame, textvariable=self.replace_var, width=15)
        self.replace_entry.pack(side="left", padx=(5, 10))
        
        # ì •ê·œí‘œí˜„ì‹ ì˜µì…˜
        self.regex_var = tk.BooleanVar()
        ttk.Checkbutton(find_replace_frame, text="ì •ê·œí‘œí˜„ì‹", 
                       variable=self.regex_var).pack(side="left", padx=(10, 0))
        
        # ì—°ë²ˆ ë§¤ê¸°ê¸° ì˜µì…˜
        numbering_frame = ttk.Frame(input_frame)
        numbering_frame.grid(row=2, column=0, sticky="ew", pady=2)
        
        ttk.Label(numbering_frame, text="ì‹œì‘ë²ˆí˜¸:").pack(side="left")
        self.start_var = tk.StringVar(value="1")
        ttk.Entry(numbering_frame, textvariable=self.start_var, width=5).pack(side="left", padx=(5, 10))
        
        ttk.Label(numbering_frame, text="ìë¦¿ìˆ˜:").pack(side="left")
        self.digits_var = tk.StringVar(value="3")
        ttk.Entry(numbering_frame, textvariable=self.digits_var, width=5).pack(side="left", padx=(5, 10))
        
        ttk.Label(numbering_frame, text="í˜•ì‹:").pack(side="left")
        self.format_var = tk.StringVar(value="{number}_{name}")
        ttk.Entry(numbering_frame, textvariable=self.format_var, width=15).pack(side="left", padx=(5, 0))
        
        input_frame.columnconfigure(0, weight=1)
    
    def create_preview_area(self, parent):
        """ë¯¸ë¦¬ë³´ê¸° ì˜ì—­ ìƒì„±"""
        preview_frame = ttk.LabelFrame(parent, text="ë¯¸ë¦¬ë³´ê¸°", padding="5")
        preview_frame.grid(row=4, column=0, columnspan=2, sticky="nsew", pady=(0, 10))
        
        # ë¯¸ë¦¬ë³´ê¸° ëª©ë¡
        columns = ("í˜„ì¬ ì´ë¦„", "ìƒˆ ì´ë¦„")
        self.preview_tree = ttk.Treeview(preview_frame, columns=columns, show="headings", height=8)
        
        self.preview_tree.heading("í˜„ì¬ ì´ë¦„", text="í˜„ì¬ ì´ë¦„")
        self.preview_tree.heading("ìƒˆ ì´ë¦„", text="ìƒˆ ì´ë¦„")
        
        self.preview_tree.column("í˜„ì¬ ì´ë¦„", width=300)
        self.preview_tree.column("ìƒˆ ì´ë¦„", width=300)
        
        # ìŠ¤í¬ë¡¤ë°”
        preview_scrollbar = ttk.Scrollbar(preview_frame, orient="vertical", command=self.preview_tree.yview)
        self.preview_tree.configure(yscrollcommand=preview_scrollbar.set)
        
        self.preview_tree.pack(side="left", fill="both", expand=True)
        preview_scrollbar.pack(side="right", fill="y")
        
        preview_frame.columnconfigure(0, weight=1)
        preview_frame.rowconfigure(0, weight=1)
    
    def create_action_buttons(self, parent):
        """ì‹¤í–‰ ë²„íŠ¼ ì˜ì—­ ìƒì„±"""
        button_frame = ttk.Frame(parent)
        button_frame.grid(row=5, column=0, columnspan=2, pady=10)
        
        ttk.Button(button_frame, text="ğŸ”„ ë¯¸ë¦¬ë³´ê¸° ìƒˆë¡œê³ ì¹¨", 
                  command=self.update_preview).pack(side="left", padx=(0, 10))
        ttk.Button(button_frame, text="âœ… ì´ë¦„ ë³€ê²½ ì‹¤í–‰", 
                  command=self.execute_rename, 
                  style="Accent.TButton").pack(side="left")
    
    def setup_preview_bindings(self):
        """ì‹¤ì‹œê°„ ë¯¸ë¦¬ë³´ê¸°ë¥¼ ìœ„í•œ ì´ë²¤íŠ¸ ë°”ì¸ë”©"""
        self.mode_var.trace('w', self.on_option_change)
        self.text_var.trace('w', self.on_option_change)
        self.find_var.trace('w', self.on_option_change)
        self.replace_var.trace('w', self.on_option_change)
        self.regex_var.trace('w', self.on_option_change)
        self.start_var.trace('w', self.on_option_change)
        self.digits_var.trace('w', self.on_option_change)
        self.format_var.trace('w', self.on_option_change)
    
    def setup_drag_drop(self):
        """ë“œë˜ê·¸ ì•¤ ë“œë¡­ ì„¤ì •"""
        if DND_AVAILABLE:
            self.drop_label.drop_target_register(DND_FILES)
            self.drop_label.dnd_bind('<<Drop>>', self.on_drop)
            self.file_tree.drop_target_register(DND_FILES)
            self.file_tree.dnd_bind('<<Drop>>', self.on_drop)
    
    def on_drop(self, event):
        """ë“œë¡­ ì´ë²¤íŠ¸ ì²˜ë¦¬"""
        files = self.root.tk.splitlist(event.data)
        self.add_files(files)
    
    def select_files(self):
        """íŒŒì¼ ì„ íƒ ë‹¤ì´ì–¼ë¡œê·¸"""
        files = filedialog.askopenfilenames(
            title="íŒŒì¼ ì„ íƒ",
            filetypes=[
                ("ëª¨ë“  íŒŒì¼", "*.*"),
                ("ì´ë¯¸ì§€ íŒŒì¼", "*.jpg *.jpeg *.png *.gif *.bmp"),
                ("ë¬¸ì„œ íŒŒì¼", "*.txt *.pdf *.doc *.docx"),
                ("ë™ì˜ìƒ íŒŒì¼", "*.mp4 *.avi *.mkv *.mov")
            ]
        )
        if files:
            self.add_files(files)
    
    def select_folder(self):
        """í´ë” ì„ íƒ ë° íŒŒì¼ ì¶”ê°€"""
        folder = filedialog.askdirectory(title="í´ë” ì„ íƒ")
        if folder:
            files = [os.path.join(folder, f) for f in os.listdir(folder) 
                    if os.path.isfile(os.path.join(folder, f))]
            self.add_files(files)
    
    def add_files(self, file_paths):
        """íŒŒì¼ ëª©ë¡ì— íŒŒì¼ ì¶”ê°€"""
        added_count = 0
        
        for file_path in file_paths:
            if os.path.isfile(file_path) and file_path not in self.files:
                self.files.append(file_path)
                
                # Treeviewì— ì¶”ê°€
                filename = os.path.basename(file_path)
                size = self.get_file_size(file_path)
                self.file_tree.insert("", "end", values=(filename, file_path, size))
                added_count += 1
        
        self.update_file_count()
        self.update_preview()
        
        if added_count > 0:
            messagebox.showinfo("íŒŒì¼ ì¶”ê°€", f"{added_count}ê°œ íŒŒì¼ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.")
    
    def get_file_size(self, file_path):
        """íŒŒì¼ í¬ê¸°ë¥¼ ì½ê¸° ì‰¬ìš´ í˜•íƒœë¡œ ë°˜í™˜"""
        try:
            size = os.path.getsize(file_path)
            if size < 1024:
                return f"{size} B"
            elif size < 1024 * 1024:
                return f"{size/1024:.1f} KB"
            else:
                return f"{size/(1024*1024):.1f} MB"
        except OSError:
            return "ì•Œ ìˆ˜ ì—†ìŒ"
    
    def clear_files(self):
        """ëª¨ë“  íŒŒì¼ ì œê±°"""
        if self.files:
            result = messagebox.askyesno("í™•ì¸", "ëª¨ë“  íŒŒì¼ì„ ì œê±°í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")
            if result:
                self.files.clear()
                self.file_tree.delete(*self.file_tree.get_children())
                self.preview_tree.delete(*self.preview_tree.get_children())
                self.update_file_count()
    
    def update_file_count(self):
        """íŒŒì¼ ê°œìˆ˜ ì—…ë°ì´íŠ¸"""
        self.file_count_var.set(f"íŒŒì¼ ê°œìˆ˜: {len(self.files)}")
    
    def on_option_change(self, *args):
        """ì˜µì…˜ ë³€ê²½ ì‹œ ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸"""
        self.update_preview()
    
    def generate_new_name(self, file_path, index):
        """ìƒˆë¡œìš´ íŒŒì¼ëª… ìƒì„±"""
        filename = os.path.basename(file_path)
        name, ext = os.path.splitext(filename)
        mode = self.mode_var.get()
        
        try:
            if mode == "prefix":
                text = self.text_var.get()
                return f"{text}{filename}"
            
            elif mode == "suffix":
                text = self.text_var.get()
                return f"{name}{text}{ext}"
            
            elif mode == "find_replace":
                find_text = self.find_var.get()
                replace_text = self.replace_var.get()
                
                if not find_text:
                    return filename
                
                if self.regex_var.get():
                    # ì •ê·œí‘œí˜„ì‹ ëª¨ë“œ
                    try:
                        return re.sub(find_text, replace_text, filename)
                    except re.error:
                        return filename  # ì •ê·œì‹ ì˜¤ë¥˜ ì‹œ ì›ë³¸ ë°˜í™˜
                else:
                    # ì¼ë°˜ ì°¾ê¸°/ë°”ê¾¸ê¸°
                    return filename.replace(find_text, replace_text)
            
            elif mode == "numbering":
                try:
                    start = int(self.start_var.get())
                    digits = int(self.digits_var.get())
                    format_str = self.format_var.get()
                    
                    number = start + index
                    number_str = f"{number:0{digits}d}"
                    
                    # í˜•ì‹ ë³€ìˆ˜ ì¹˜í™˜
                    new_name = format_str.format(
                        number=number_str,
                        name=name,
                        ext=ext[1:] if ext else "",
                        filename=filename,
                        index=index
                    )
                    
                    # í™•ì¥ìê°€ ì—†ìœ¼ë©´ ì›ë³¸ í™•ì¥ì ì¶”ê°€
                    if not new_name.endswith(ext) and ext:
                        new_name += ext
                    
                    return new_name
                    
                except (ValueError, KeyError):
                    return filename
            
        except Exception:
            return filename
        
        return filename
    
    def update_preview(self):
        """ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸"""
        # ê¸°ì¡´ ë¯¸ë¦¬ë³´ê¸° ì‚­ì œ
        self.preview_tree.delete(*self.preview_tree.get_children())
        
        # ìƒˆ ë¯¸ë¦¬ë³´ê¸° ìƒì„±
        for index, file_path in enumerate(self.files):
            current_name = os.path.basename(file_path)
            new_name = self.generate_new_name(file_path, index)
            
            # ë³€ê²½ì‚¬í•­ì´ ìˆìœ¼ë©´ í•˜ì´ë¼ì´íŠ¸
            if current_name != new_name:
                tag = "changed"
            else:
                tag = "unchanged"
            
            item_id = self.preview_tree.insert("", "end", values=(current_name, new_name), tags=(tag,))
        
        # íƒœê·¸ ìƒ‰ìƒ ì„¤ì •
        self.preview_tree.tag_configure("changed", background="#e8f5e8")
        self.preview_tree.tag_configure("unchanged", background="#f5f5f5")
    
    def execute_rename(self):
        """ì‹¤ì œ íŒŒì¼ëª… ë³€ê²½ ì‹¤í–‰"""
        if not self.files:
            messagebox.showwarning("ê²½ê³ ", "ë³€ê²½í•  íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.")
            return
        
        # ë³€ê²½ ê³„íš ìƒì„±
        rename_plan = []
        for index, file_path in enumerate(self.files):
            current_name = os.path.basename(file_path)
            new_name = self.generate_new_name(file_path, index)
            
            if current_name != new_name:
                directory = os.path.dirname(file_path)
                new_path = os.path.join(directory, new_name)
                rename_plan.append((file_path, new_path))
        
        if not rename_plan:
            messagebox.showinfo("ì •ë³´", "ë³€ê²½í•  íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.")
            return
        
        # í™•ì¸ ëŒ€í™”ìƒì
        result = messagebox.askyesno(
            "í™•ì¸", 
            f"{len(rename_plan)}ê°œ íŒŒì¼ì˜ ì´ë¦„ì„ ë³€ê²½í•˜ì‹œê² ìŠµë‹ˆê¹Œ?"
        )
        
        if not result:
            return
        
        # ì‹¤í–‰
        success_count = 0
        errors = []
        
        for old_path, new_path in rename_plan:
            try:
                # ë™ì¼í•œ ì´ë¦„ì˜ íŒŒì¼ì´ ì´ë¯¸ ìˆëŠ”ì§€ í™•ì¸
                if os.path.exists(new_path):
                    errors.append(f"{os.path.basename(old_path)}: ëŒ€ìƒ íŒŒì¼ì´ ì´ë¯¸ ì¡´ì¬í•¨")
                    continue
                
                os.rename(old_path, new_path)
                success_count += 1
                
                # ë‚´ë¶€ íŒŒì¼ ëª©ë¡ ì—…ë°ì´íŠ¸
                index = self.files.index(old_path)
                self.files[index] = new_path
                
            except Exception as e:
                errors.append(f"{os.path.basename(old_path)}: {str(e)}")
        
        # ê²°ê³¼ ë³´ê³ 
        result_msg = f"ì„±ê³µ: {success_count}ê°œ íŒŒì¼ ë³€ê²½ë¨"
        if errors:
            result_msg += f"\nì‹¤íŒ¨: {len(errors)}ê°œ"
            if len(errors) <= 5:
                result_msg += "\n" + "\n".join(errors)
        
        messagebox.showinfo("ì‘ì—… ì™„ë£Œ", result_msg)
        
        # UI ì—…ë°ì´íŠ¸
        self.refresh_file_list()
        self.update_preview()
    
    def refresh_file_list(self):
        """íŒŒì¼ ëª©ë¡ ìƒˆë¡œê³ ì¹¨"""
        self.file_tree.delete(*self.file_tree.get_children())
        
        for file_path in self.files:
            if os.path.exists(file_path):
                filename = os.path.basename(file_path)
                size = self.get_file_size(file_path)
                self.file_tree.insert("", "end", values=(filename, file_path, size))
            else:
                # íŒŒì¼ì´ ì—†ìœ¼ë©´ ëª©ë¡ì—ì„œ ì œê±°
                self.files.remove(file_path)
        
        self.update_file_count()
    
    def run(self):
        self.root.mainloop()

if __name__ == "__main__":
    app = FindReplaceFileRenamer()
    app.run()
```

### Step 4ì—ì„œ ì¶”ê°€ëœ ìƒˆë¡œìš´ ê¸°ëŠ¥ë“¤

#### 1. ë‹¤ì–‘í•œ ì´ë¦„ ë³€ê²½ ëª¨ë“œ

=== "ì ‘ë‘ì‚¬/ì ‘ë¯¸ì‚¬"
    ê¸°ì¡´ì˜ ê°„ë‹¨í•œ í…ìŠ¤íŠ¸ ì¶”ê°€ ê¸°ëŠ¥
    ```
    ì ‘ë‘ì‚¬: "new_" â†’ photo.jpg â†’ new_photo.jpg
    ì ‘ë¯¸ì‚¬: "_backup" â†’ document.txt â†’ document_backup.txt
    ```

=== "ì°¾ê¸°/ë°”ê¾¸ê¸°"
    íŠ¹ì • ë¬¸ìì—´ì„ ë‹¤ë¥¸ ë¬¸ìì—´ë¡œ êµì²´
    ```
    ì°¾ê¸°: "IMG" ë°”ê¾¸ê¸°: "Photo"
    IMG_001.jpg â†’ Photo_001.jpg
    ```

=== "ì •ê·œí‘œí˜„ì‹"
    ë³µì¡í•œ íŒ¨í„´ ë§¤ì¹­ ì§€ì›
    ```
    ì •ê·œì‹: (\d{4})-(\d{2})-(\d{2})
    ë°”ê¾¸ê¸°: \3-\2-\1
    2023-12-25.txt â†’ 25-12-2023.txt
    ```

=== "ì—°ë²ˆ ë§¤ê¸°ê¸°"
    íŒŒì¼ë“¤ì— ìˆœì°¨ì ìœ¼ë¡œ ë²ˆí˜¸ ë¶€ì—¬
    ```
    í˜•ì‹: "{number:03d}_{name}"
    photo.jpg â†’ 001_photo.jpg
    document.txt â†’ 002_document.txt
    ```

#### 2. ì‹¤ì‹œê°„ ë¯¸ë¦¬ë³´ê¸°

ëª¨ë“  ì˜µì…˜ ë³€ê²½ì‚¬í•­ì´ ì¦‰ì‹œ ë¯¸ë¦¬ë³´ê¸°ì— ë°˜ì˜ë©ë‹ˆë‹¤:

- **ìƒ‰ìƒ ì½”ë”©**: ë³€ê²½ë˜ëŠ” íŒŒì¼ì€ ì—°í•œ ì´ˆë¡ìƒ‰, ë³€ê²½ë˜ì§€ ì•ŠëŠ” íŒŒì¼ì€ íšŒìƒ‰
- **ìë™ ìƒˆë¡œê³ ì¹¨**: ì˜µì…˜ ë³€ê²½ ì‹œ ìë™ìœ¼ë¡œ ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸
- **ì—ëŸ¬ ë°©ì§€**: ì˜ëª»ëœ ì •ê·œì‹ì´ë‚˜ í˜•ì‹ ì˜¤ë¥˜ ì‹œ ì›ë³¸ íŒŒì¼ëª… ìœ ì§€

#### 3. ê³ ê¸‰ ì—°ë²ˆ ë§¤ê¸°ê¸° ì˜µì…˜

```python
# ì‚¬ìš© ê°€ëŠ¥í•œ í˜•ì‹ ë³€ìˆ˜
{number}    # ì—°ë²ˆ (ìë¦¿ìˆ˜ ì˜µì…˜ ì ìš©)
{name}      # íŒŒì¼ëª… (í™•ì¥ì ì œì™¸)
{ext}       # í™•ì¥ì (ì  ì œì™¸)
{filename}  # ì „ì²´ íŒŒì¼ëª…
{index}     # 0ë¶€í„° ì‹œì‘í•˜ëŠ” ì¸ë±ìŠ¤

# ì˜ˆì‹œ í˜•ì‹ë“¤
"{number:03d}_{name}"           # 001_photo, 002_document
"[{number}] {filename}"         # [1] photo.jpg, [2] document.txt
"File_{number:04d}.{ext}"       # File_0001.jpg, File_0002.txt
```

#### 4. ì •ê·œí‘œí˜„ì‹ ì§€ì›

ì •ê·œí‘œí˜„ì‹ ì²´í¬ë°•ìŠ¤ë¥¼ ì„ íƒí•˜ë©´ ê°•ë ¥í•œ íŒ¨í„´ ë§¤ì¹­ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```regex
# ë‚ ì§œ í˜•ì‹ ë³€ê²½
(\d{4})-(\d{2})-(\d{2})  â†’  \3/\2/\1
2023-12-25 â†’ 25/12/2023

# ë²ˆí˜¸ íŒ¨ë”©
IMG_(\d+)  â†’  IMG_\1.jpg
IMG_5 â†’ IMG_5.jpg

# ê³µë°± ì œê±°
\s+  â†’  _
My Document.txt â†’ My_Document.txt
```

!!! tip "ì •ê·œí‘œí˜„ì‹ íŒ"
    - `\1`, `\2` ë“±ì€ ê´„í˜¸ë¡œ ë¬¶ì¸ ê·¸ë£¹ì„ ì°¸ì¡°í•©ë‹ˆë‹¤
    - ì •ê·œì‹ì´ ì˜ëª»ë˜ë©´ ì›ë³¸ íŒŒì¼ëª…ì´ ìœ ì§€ë©ë‹ˆë‹¤
    - ë³µì¡í•œ íŒ¨í„´ì€ ë¯¸ë¦¬ë³´ê¸°ì—ì„œ ë¨¼ì € í™•ì¸í•˜ì„¸ìš”

#### 5. í–¥ìƒëœ UI/UX

- **ëª¨ë“œë³„ ì…ë ¥ í•„ë“œ**: ì„ íƒí•œ ëª¨ë“œì— ë”°ë¼ ê´€ë ¨ ì˜µì…˜ë§Œ í™œì„±í™”
- **ì‹¤ì‹œê°„ í”¼ë“œë°±**: ëª¨ë“  ë³€ê²½ì‚¬í•­ì´ ì¦‰ì‹œ ë¯¸ë¦¬ë³´ê¸°ì— ë°˜ì˜
- **ì§ê´€ì  ë ˆì´ì•„ì›ƒ**: ë…¼ë¦¬ì  ìˆœì„œë¡œ ë°°ì¹˜ëœ UI ìš”ì†Œë“¤
- **ì—ëŸ¬ ì•ˆì „ì„±**: ì˜ëª»ëœ ì…ë ¥ì— ëŒ€í•œ ì•ˆì „í•œ ì²˜ë¦¬

### ì‹¤í–‰ ê²°ê³¼

![Step 4 ì‹¤í–‰ í™”ë©´](images/ch4_step4.png)

*Step 4ì—ì„œëŠ” ë‹¨ìˆœí•œ ì ‘ë‘ì‚¬/ì ‘ë¯¸ì‚¬ë¥¼ ë„˜ì–´ì„œ ì •ê·œí‘œí˜„ì‹ê³¼ ì—°ë²ˆ ë§¤ê¸°ê¸° ë“± ì „ë¬¸ì ì¸ íŒŒì¼ëª… ë³€ê²½ ê¸°ëŠ¥ì„ GUIë¡œ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.*

---

## ğŸ¯ Step 5: íŒŒì¼ ê´€ë¦¬ ê¸°ëŠ¥ìœ¼ë¡œ ì™„ì„±ë„ ë†’ì´ê¸°

### ëª©í‘œ
Step 4ì˜ ê°•ë ¥í•œ ì´ë¦„ ë³€ê²½ ê¸°ëŠ¥ì— **ì•ˆì „ì„±ê³¼ í¸ì˜ì„±ì„ ë†’ì´ëŠ” ê³ ê¸‰ ê¸°ëŠ¥ë“¤**<!-- -->ì„ ì¶”ê°€í•©ë‹ˆë‹¤. ë°±ì—…, ì‹¤í–‰ ì·¨ì†Œ, ì¡°ê±´ë¶€ í•„í„°ë§, ë°°ì¹˜ ì²˜ë¦¬ ë“±ì„ êµ¬í˜„í•˜ì—¬ ì™„ì„±ë„ ë†’ì€ íŒŒì¼ ê´€ë¦¬ ë„êµ¬ë¥¼ ë§Œë“­ë‹ˆë‹¤.

### step5_file_management.py

```python linenums="1" title="src/chapter4/step5_file_management.py"
import tkinter as tk
from tkinter import ttk, filedialog, messagebox
import os
import re
import shutil
import json
from datetime import datetime
from pathlib import Path

# ë“œë˜ê·¸ ì•¤ ë“œë¡­ ë¼ì´ë¸ŒëŸ¬ë¦¬ (ì„ íƒì )
try:
    from tkinterdnd2 import DND_FILES, TkinterDnD
    DND_AVAILABLE = True
except ImportError:
    DND_AVAILABLE = False

class FileManagementRenamer:
    def __init__(self):
        # ë“œë˜ê·¸ ì•¤ ë“œë¡­ ì§€ì› ì—¬ë¶€ì— ë”°ë¼ ë‹¤ë¥¸ ë°©ì‹ìœ¼ë¡œ ìœˆë„ìš° ìƒì„±
        if DND_AVAILABLE:
            self.root = TkinterDnD.Tk()
        else:
            self.root = tk.Tk()
        
        self.root.title("íŒŒì¼ ë¦¬ë„¤ì´ë¨¸ v5.0 - ì™„ì„±ëœ íŒŒì¼ ê´€ë¦¬")
        self.root.geometry("900x800")
        
        self.files = []
        self.backup_history = []  # ë°±ì—… íˆìŠ¤í† ë¦¬
        self.filter_enabled = False
        
        self.create_widgets()
        self.setup_drag_drop()
        self.setup_preview_bindings()
        self.setup_menu()
        
        # ì„¤ì • ë¡œë“œ
        self.load_settings()
    
    def create_widgets(self):
        # ë©”ì¸ í”„ë ˆì„
        main_frame = ttk.Frame(self.root, padding="10")
        main_frame.grid(row=0, column=0, sticky="nsew")
        
        # ì œëª©
        title_label = ttk.Label(main_frame, text="ì™„ì„±ëœ íŒŒì¼ ê´€ë¦¬ ë„êµ¬", 
                               font=("ë§‘ì€ ê³ ë”•", 16, "bold"))
        title_label.grid(row=0, column=0, columnspan=3, pady=(0, 15))
        
        # ì¢Œì¸¡ íŒ¨ë„ (íŒŒì¼ ê´€ë¦¬)
        self.create_left_panel(main_frame)
        
        # ìš°ì¸¡ íŒ¨ë„ (ì˜µì…˜ ë° ë¯¸ë¦¬ë³´ê¸°)
        self.create_right_panel(main_frame)
        
        # í•˜ë‹¨ ìƒíƒœë°”
        self.create_status_bar(main_frame)
        
        # ê·¸ë¦¬ë“œ ê°€ì¤‘ì¹˜ ì„¤ì •
        self.root.columnconfigure(0, weight=1)
        self.root.rowconfigure(0, weight=1)
        main_frame.columnconfigure(0, weight=1)
        main_frame.columnconfigure(1, weight=1)
        main_frame.rowconfigure(1, weight=1)
    
    def create_left_panel(self, parent):
        """ì¢Œì¸¡ íŒ¨ë„ - íŒŒì¼ ê´€ë¦¬"""
        left_frame = ttk.Frame(parent)
        left_frame.grid(row=1, column=0, sticky="nsew", padx=(0, 5))
        
        # ë“œë˜ê·¸ ì•¤ ë“œë¡­ ì˜ì—­
        self.create_drop_area(left_frame)
        
        # íŒŒì¼ ëª©ë¡ ì˜ì—­
        self.create_file_list(left_frame)
        
        # íŒŒì¼ ê´€ë¦¬ ë²„íŠ¼
        self.create_file_management_buttons(left_frame)
        
        left_frame.columnconfigure(0, weight=1)
        left_frame.rowconfigure(2, weight=1)
    
    def create_right_panel(self, parent):
        """ìš°ì¸¡ íŒ¨ë„ - ì˜µì…˜ ë° ë¯¸ë¦¬ë³´ê¸°"""
        right_frame = ttk.Frame(parent)
        right_frame.grid(row=1, column=1, sticky="nsew", padx=(5, 0))
        
        # í•„í„° ì˜µì…˜
        self.create_filter_options(right_frame)
        
        # ì´ë¦„ ë³€ê²½ ì˜µì…˜
        self.create_rename_options(right_frame)
        
        # ë¯¸ë¦¬ë³´ê¸° ì˜ì—­
        self.create_preview_area(right_frame)
        
        # ì‹¤í–‰ ë²„íŠ¼ë“¤
        self.create_action_buttons(right_frame)
        
        right_frame.columnconfigure(0, weight=1)
        right_frame.rowconfigure(3, weight=1)
    
    def create_drop_area(self, parent):
        """ë“œë˜ê·¸ ì•¤ ë“œë¡­ ì˜ì—­"""
        drop_frame = ttk.LabelFrame(parent, text="íŒŒì¼ ì¶”ê°€", padding="10")
        drop_frame.grid(row=0, column=0, sticky="ew", pady=(0, 10))
        
        if DND_AVAILABLE:
            drop_text = "ğŸ“ íŒŒì¼ì„ ë“œë˜ê·¸ ì•¤ ë“œë¡­í•˜ì„¸ìš”"
            bg_color = "#e8f4fd"
        else:
            drop_text = "âš ï¸ ë“œë˜ê·¸ ì•¤ ë“œë¡­ ë¶ˆê°€ëŠ¥"
            bg_color = "#fff2cc"
        
        self.drop_label = tk.Label(
            drop_frame, 
            text=drop_text,
            font=("ë§‘ì€ ê³ ë”•", 11),
            bg=bg_color,
            relief="ridge",
            bd=2,
            height=2
        )
        self.drop_label.pack(fill="x", pady=(0, 10))
        
        # íŒŒì¼ ì¶”ê°€ ë²„íŠ¼ë“¤
        btn_frame = ttk.Frame(drop_frame)
        btn_frame.pack(fill="x")
        
        ttk.Button(btn_frame, text="ğŸ“„ íŒŒì¼ ì„ íƒ", 
                  command=self.select_files).pack(side="left", padx=(0, 5))
        ttk.Button(btn_frame, text="ğŸ“‚ í´ë” ì„ íƒ", 
                  command=self.select_folder).pack(side="left", padx=(0, 5))
        ttk.Button(btn_frame, text="ğŸ“‚ ì¬ê·€ í´ë”", 
                  command=self.select_folder_recursive).pack(side="left")
    
    def create_file_list(self, parent):
        """íŒŒì¼ ëª©ë¡ ì˜ì—­"""
        list_frame = ttk.LabelFrame(parent, text="íŒŒì¼ ëª©ë¡", padding="5")
        list_frame.grid(row=1, column=0, sticky="nsew", pady=(0, 10))
        
        # íŒŒì¼ ì¹´ìš´í„°ì™€ í•„í„° ì •ë³´
        info_frame = ttk.Frame(list_frame)
        info_frame.pack(fill="x", pady=(0, 5))
        
        self.file_count_var = tk.StringVar(value="íŒŒì¼ ê°œìˆ˜: 0")
        ttk.Label(info_frame, textvariable=self.file_count_var).pack(side="left")
        
        self.filter_info_var = tk.StringVar(value="")
        ttk.Label(info_frame, textvariable=self.filter_info_var, 
                 foreground="blue").pack(side="left", padx=(10, 0))
        
        # íŒŒì¼ ëª©ë¡ (Treeview with ë” ë§ì€ ì •ë³´)
        columns = ("íŒŒì¼ëª…", "í¬ê¸°", "ìˆ˜ì •ì¼", "í™•ì¥ì", "ê²½ë¡œ")
        self.file_tree = ttk.Treeview(list_frame, columns=columns, show="headings", height=10)
        
        # ì»¬ëŸ¼ ì„¤ì •
        self.file_tree.heading("íŒŒì¼ëª…", text="íŒŒì¼ëª…")
        self.file_tree.heading("í¬ê¸°", text="í¬ê¸°")
        self.file_tree.heading("ìˆ˜ì •ì¼", text="ìˆ˜ì •ì¼")
        self.file_tree.heading("í™•ì¥ì", text="í™•ì¥ì")
        self.file_tree.heading("ê²½ë¡œ", text="ê²½ë¡œ")
        
        self.file_tree.column("íŒŒì¼ëª…", width=150)
        self.file_tree.column("í¬ê¸°", width=80)
        self.file_tree.column("ìˆ˜ì •ì¼", width=100)
        self.file_tree.column("í™•ì¥ì", width=60)
        self.file_tree.column("ê²½ë¡œ", width=200)
        
        # ìŠ¤í¬ë¡¤ë°”
        tree_scroll = ttk.Scrollbar(list_frame, orient="vertical", command=self.file_tree.yview)
        self.file_tree.configure(yscrollcommand=tree_scroll.set)
        
        self.file_tree.pack(side="left", fill="both", expand=True)
        tree_scroll.pack(side="right", fill="y")
        
        # ë”ë¸”í´ë¦­ìœ¼ë¡œ íŒŒì¼ ì—´ê¸°
        self.file_tree.bind("<Double-1>", self.open_file_location)
        
        list_frame.columnconfigure(0, weight=1)
        list_frame.rowconfigure(1, weight=1)
    
    def create_file_management_buttons(self, parent):
        """íŒŒì¼ ê´€ë¦¬ ë²„íŠ¼ë“¤"""
        mgmt_frame = ttk.Frame(parent)
        mgmt_frame.grid(row=2, column=0, sticky="ew", pady=(0, 10))
        
        ttk.Button(mgmt_frame, text="ğŸ—‘ï¸ ì„ íƒ ì œê±°", 
                  command=self.remove_selected).pack(side="left", padx=(0, 5))
        ttk.Button(mgmt_frame, text="ğŸ—‘ï¸ ì „ì²´ ì œê±°", 
                  command=self.clear_files).pack(side="left", padx=(0, 5))
        ttk.Button(mgmt_frame, text="â†•ï¸ ì •ë ¬", 
                  command=self.sort_files).pack(side="left", padx=(0, 5))
        ttk.Button(mgmt_frame, text="ğŸ”„ ìƒˆë¡œê³ ì¹¨", 
                  command=self.refresh_files).pack(side="left")
    
    def create_filter_options(self, parent):
        """í•„í„° ì˜µì…˜"""
        filter_frame = ttk.LabelFrame(parent, text="íŒŒì¼ í•„í„°", padding="10")
        filter_frame.grid(row=0, column=0, sticky="ew", pady=(0, 10))
        
        # í•„í„° í™œì„±í™”
        self.filter_enabled_var = tk.BooleanVar()
        filter_check = ttk.Checkbutton(filter_frame, text="í•„í„° ì‚¬ìš©", 
                                      variable=self.filter_enabled_var,
                                      command=self.on_filter_change)
        filter_check.pack(anchor="w", pady=(0, 5))
        
        # í•„í„° ì˜µì…˜ë“¤
        filter_options = ttk.Frame(filter_frame)
        filter_options.pack(fill="x")
        
        # í™•ì¥ì í•„í„°
        ttk.Label(filter_options, text="í™•ì¥ì:").grid(row=0, column=0, sticky="w", pady=2)
        self.ext_filter_var = tk.StringVar()
        ttk.Entry(filter_options, textvariable=self.ext_filter_var, 
                 width=20).grid(row=0, column=1, sticky="ew", padx=(5, 0), pady=2)
        
        # í¬ê¸° í•„í„°
        ttk.Label(filter_options, text="ìµœì†Œ í¬ê¸°:").grid(row=1, column=0, sticky="w", pady=2)
        self.min_size_var = tk.StringVar()
        ttk.Entry(filter_options, textvariable=self.min_size_var, 
                 width=20).grid(row=1, column=1, sticky="ew", padx=(5, 0), pady=2)
        
        ttk.Label(filter_options, text="ìµœëŒ€ í¬ê¸°:").grid(row=2, column=0, sticky="w", pady=2)
        self.max_size_var = tk.StringVar()
        ttk.Entry(filter_options, textvariable=self.max_size_var, 
                 width=20).grid(row=2, column=1, sticky="ew", padx=(5, 0), pady=2)
        
        # íŒŒì¼ëª… íŒ¨í„´ í•„í„°
        ttk.Label(filter_options, text="íŒŒì¼ëª… íŒ¨í„´:").grid(row=3, column=0, sticky="w", pady=2)
        self.pattern_var = tk.StringVar()
        ttk.Entry(filter_options, textvariable=self.pattern_var, 
                 width=20).grid(row=3, column=1, sticky="ew", padx=(5, 0), pady=2)
        
        filter_options.columnconfigure(1, weight=1)
        
        # í•„í„° ì´ë²¤íŠ¸ ë°”ì¸ë”©
        self.ext_filter_var.trace('w', self.on_filter_change)
        self.min_size_var.trace('w', self.on_filter_change)
        self.max_size_var.trace('w', self.on_filter_change)
        self.pattern_var.trace('w', self.on_filter_change)
    
    def create_rename_options(self, parent):
        """ì´ë¦„ ë³€ê²½ ì˜µì…˜"""
        options_frame = ttk.LabelFrame(parent, text="ì´ë¦„ ë³€ê²½ ì˜µì…˜", padding="10")
        options_frame.grid(row=1, column=0, sticky="ew", pady=(0, 10))
        
        # ëª¨ë“œ ì„ íƒ
        self.mode_var = tk.StringVar(value="prefix")
        
        mode_frame = ttk.Frame(options_frame)
        mode_frame.pack(fill="x", pady=(0, 10))
        
        modes = [
            ("ì ‘ë‘ì‚¬", "prefix"),
            ("ì ‘ë¯¸ì‚¬", "suffix"),
            ("ì°¾ê¸°/ë°”ê¾¸ê¸°", "find_replace"),
            ("ì—°ë²ˆ", "numbering"),
            ("í…œí”Œë¦¿", "template")
        ]
        
        for i, (text, value) in enumerate(modes):
            ttk.Radiobutton(mode_frame, text=text, variable=self.mode_var, 
                           value=value).grid(row=0, column=i, padx=(0, 10))
        
        # ì…ë ¥ ì˜ì—­
        self.create_option_inputs(options_frame)
        
        # ê³ ê¸‰ ì˜µì…˜
        advanced_frame = ttk.Frame(options_frame)
        advanced_frame.pack(fill="x", pady=(10, 0))
        
        self.preserve_case_var = tk.BooleanVar()
        ttk.Checkbutton(advanced_frame, text="ëŒ€ì†Œë¬¸ì ë³´ì¡´", 
                       variable=self.preserve_case_var).pack(side="left", padx=(0, 10))
        
        self.backup_enabled_var = tk.BooleanVar(value=True)
        ttk.Checkbutton(advanced_frame, text="ë°±ì—… ìƒì„±", 
                       variable=self.backup_enabled_var).pack(side="left")
    
    def create_option_inputs(self, parent):
        """ì˜µì…˜ ì…ë ¥ í•„ë“œë“¤"""
        input_frame = ttk.Frame(parent)
        input_frame.pack(fill="x")
        
        # ê¸°ë³¸ í…ìŠ¤íŠ¸ ì…ë ¥
        basic_frame = ttk.Frame(input_frame)
        basic_frame.grid(row=0, column=0, sticky="ew", pady=2)
        
        ttk.Label(basic_frame, text="í…ìŠ¤íŠ¸:").pack(side="left")
        self.text_var = tk.StringVar()
        ttk.Entry(basic_frame, textvariable=self.text_var, width=20).pack(side="left", padx=(5, 0))
        
        # ì°¾ê¸°/ë°”ê¾¸ê¸°
        find_frame = ttk.Frame(input_frame)
        find_frame.grid(row=1, column=0, sticky="ew", pady=2)
        
        ttk.Label(find_frame, text="ì°¾ê¸°:").pack(side="left")
        self.find_var = tk.StringVar()
        ttk.Entry(find_frame, textvariable=self.find_var, width=12).pack(side="left", padx=(5, 10))
        
        ttk.Label(find_frame, text="ë°”ê¾¸ê¸°:").pack(side="left")
        self.replace_var = tk.StringVar()
        ttk.Entry(find_frame, textvariable=self.replace_var, width=12).pack(side="left", padx=(5, 0))
        
        # ì •ê·œì‹ ë° ëŒ€ì†Œë¬¸ì ì˜µì…˜
        options_subframe = ttk.Frame(find_frame)
        options_subframe.pack(side="right", padx=(10, 0))
        
        self.regex_var = tk.BooleanVar()
        ttk.Checkbutton(options_subframe, text="ì •ê·œì‹", 
                       variable=self.regex_var).pack(side="left")
        
        self.ignore_case_var = tk.BooleanVar()
        ttk.Checkbutton(options_subframe, text="ëŒ€ì†Œë¬¸ì ë¬´ì‹œ", 
                       variable=self.ignore_case_var).pack(side="left", padx=(5, 0))
        
        # ì—°ë²ˆ ë§¤ê¸°ê¸°
        number_frame = ttk.Frame(input_frame)
        number_frame.grid(row=2, column=0, sticky="ew", pady=2)
        
        ttk.Label(number_frame, text="ì‹œì‘:").pack(side="left")
        self.start_var = tk.StringVar(value="1")
        ttk.Entry(number_frame, textvariable=self.start_var, width=5).pack(side="left", padx=(5, 10))
        
        ttk.Label(number_frame, text="ìë¦¿ìˆ˜:").pack(side="left")
        self.digits_var = tk.StringVar(value="3")
        ttk.Entry(number_frame, textvariable=self.digits_var, width=5).pack(side="left", padx=(5, 10))
        
        ttk.Label(number_frame, text="ì¦ê°€ê°’:").pack(side="left")
        self.step_var = tk.StringVar(value="1")
        ttk.Entry(number_frame, textvariable=self.step_var, width=5).pack(side="left", padx=(5, 0))
        
        # í…œí”Œë¦¿
        template_frame = ttk.Frame(input_frame)
        template_frame.grid(row=3, column=0, sticky="ew", pady=2)
        
        ttk.Label(template_frame, text="í…œí”Œë¦¿:").pack(side="left")
        self.template_var = tk.StringVar(value="{number:03d}_{name}")
        ttk.Entry(template_frame, textvariable=self.template_var, width=30).pack(side="left", padx=(5, 0))
        
        input_frame.columnconfigure(0, weight=1)
    
    def create_preview_area(self, parent):
        """ë¯¸ë¦¬ë³´ê¸° ì˜ì—­"""
        preview_frame = ttk.LabelFrame(parent, text="ë¯¸ë¦¬ë³´ê¸°", padding="5")
        preview_frame.grid(row=2, column=0, sticky="nsew", pady=(0, 10))
        
        # ë¯¸ë¦¬ë³´ê¸° ì„¤ì •
        preview_settings = ttk.Frame(preview_frame)
        preview_settings.pack(fill="x", pady=(0, 5))
        
        self.preview_auto_var = tk.BooleanVar(value=True)
        ttk.Checkbutton(preview_settings, text="ìë™ ë¯¸ë¦¬ë³´ê¸°", 
                       variable=self.preview_auto_var).pack(side="left")
        
        ttk.Button(preview_settings, text="ğŸ”„ ìƒˆë¡œê³ ì¹¨", 
                  command=self.update_preview).pack(side="right")
        
        # ë¯¸ë¦¬ë³´ê¸° ëª©ë¡
        columns = ("í˜„ì¬ ì´ë¦„", "ìƒˆ ì´ë¦„", "ìƒíƒœ")
        self.preview_tree = ttk.Treeview(preview_frame, columns=columns, show="headings", height=10)
        
        self.preview_tree.heading("í˜„ì¬ ì´ë¦„", text="í˜„ì¬ ì´ë¦„")
        self.preview_tree.heading("ìƒˆ ì´ë¦„", text="ìƒˆ ì´ë¦„")
        self.preview_tree.heading("ìƒíƒœ", text="ìƒíƒœ")
        
        self.preview_tree.column("í˜„ì¬ ì´ë¦„", width=150)
        self.preview_tree.column("ìƒˆ ì´ë¦„", width=150)
        self.preview_tree.column("ìƒíƒœ", width=80)
        
        # ìŠ¤í¬ë¡¤ë°”
        preview_scroll = ttk.Scrollbar(preview_frame, orient="vertical", command=self.preview_tree.yview)
        self.preview_tree.configure(yscrollcommand=preview_scroll.set)
        
        self.preview_tree.pack(side="left", fill="both", expand=True)
        preview_scroll.pack(side="right", fill="y")
        
        preview_frame.columnconfigure(0, weight=1)
        preview_frame.rowconfigure(1, weight=1)
    
    def create_action_buttons(self, parent):
        """ì‹¤í–‰ ë²„íŠ¼ë“¤"""
        action_frame = ttk.Frame(parent)
        action_frame.grid(row=3, column=0, sticky="ew", pady=10)
        
        # ì²« ë²ˆì§¸ ì¤„
        top_buttons = ttk.Frame(action_frame)
        top_buttons.pack(fill="x", pady=(0, 5))
        
        ttk.Button(top_buttons, text="ğŸ’¾ ì„¤ì • ì €ì¥", 
                  command=self.save_settings).pack(side="left", padx=(0, 5))
        ttk.Button(top_buttons, text="ğŸ“‚ ì„¤ì • ë¶ˆëŸ¬ì˜¤ê¸°", 
                  command=self.load_settings_dialog).pack(side="left", padx=(0, 5))
        ttk.Button(top_buttons, text="â†©ï¸ ì‹¤í–‰ ì·¨ì†Œ", 
                  command=self.undo_last_operation).pack(side="right")
        
        # ë‘ ë²ˆì§¸ ì¤„
        bottom_buttons = ttk.Frame(action_frame)
        bottom_buttons.pack(fill="x")
        
        ttk.Button(bottom_buttons, text="ğŸ§ª í…ŒìŠ¤íŠ¸ ì‹¤í–‰", 
                  command=self.test_execution).pack(side="left", padx=(0, 10))
        
        ttk.Button(bottom_buttons, text="âœ… ì‹¤í–‰", 
                  command=self.execute_rename,
                  style="Accent.TButton").pack(side="right", padx=(10, 0))
        
        ttk.Button(bottom_buttons, text="âš¡ ì¼ê´„ ì‹¤í–‰", 
                  command=self.batch_execute).pack(side="right")
    
    def create_status_bar(self, parent):
        """ìƒíƒœë°”"""
        status_frame = ttk.Frame(parent)
        status_frame.grid(row=2, column=0, columnspan=3, sticky="ew", pady=(10, 0))
        
        self.status_var = tk.StringVar(value="ì¤€ë¹„")
        ttk.Label(status_frame, textvariable=self.status_var).pack(side="left")
        
        # ì§„í–‰ë¥  í‘œì‹œ
        self.progress_var = tk.DoubleVar()
        self.progress_bar = ttk.Progressbar(status_frame, variable=self.progress_var, 
                                           length=200, mode='determinate')
        self.progress_bar.pack(side="right", padx=(10, 0))
        
        self.progress_text_var = tk.StringVar()
        ttk.Label(status_frame, textvariable=self.progress_text_var).pack(side="right", padx=(0, 10))
    
    def setup_menu(self):
        """ë©”ë‰´ë°” ì„¤ì •"""
        menubar = tk.Menu(self.root)
        self.root.config(menu=menubar)
        
        # íŒŒì¼ ë©”ë‰´
        file_menu = tk.Menu(menubar, tearoff=0)
        menubar.add_cascade(label="íŒŒì¼", menu=file_menu)
        file_menu.add_command(label="í”„ë¡œì íŠ¸ ì €ì¥", command=self.save_project)
        file_menu.add_command(label="í”„ë¡œì íŠ¸ ì—´ê¸°", command=self.load_project)
        file_menu.add_separator()
        file_menu.add_command(label="ì„¤ì •", command=self.show_preferences)
        file_menu.add_separator()
        file_menu.add_command(label="ì¢…ë£Œ", command=self.root.quit)
        
        # í¸ì§‘ ë©”ë‰´
        edit_menu = tk.Menu(menubar, tearoff=0)
        menubar.add_cascade(label="í¸ì§‘", menu=edit_menu)
        edit_menu.add_command(label="ëª¨ë‘ ì„ íƒ", command=self.select_all_files)
        edit_menu.add_command(label="ì„ íƒ í•´ì œ", command=self.deselect_all_files)
        edit_menu.add_separator()
        edit_menu.add_command(label="ì‹¤í–‰ ì·¨ì†Œ", command=self.undo_last_operation)
        
        # ë„êµ¬ ë©”ë‰´
        tools_menu = tk.Menu(menubar, tearoff=0)
        menubar.add_cascade(label="ë„êµ¬", menu=tools_menu)
        tools_menu.add_command(label="ì¤‘ë³µ íŒŒì¼ ì°¾ê¸°", command=self.find_duplicates)
        tools_menu.add_command(label="íŒŒì¼ ê²€ì¦", command=self.validate_files)
        tools_menu.add_command(label="í†µê³„ ë³´ê¸°", command=self.show_statistics)
        
        # ë„ì›€ë§ ë©”ë‰´
        help_menu = tk.Menu(menubar, tearoff=0)
        menubar.add_cascade(label="ë„ì›€ë§", menu=help_menu)
        help_menu.add_command(label="ì‚¬ìš©ë²•", command=self.show_help)
        help_menu.add_command(label="ì •ë³´", command=self.show_about)
    
    def setup_drag_drop(self):
        """ë“œë˜ê·¸ ì•¤ ë“œë¡­ ì„¤ì •"""
        if DND_AVAILABLE:
            self.drop_label.drop_target_register(DND_FILES)
            self.drop_label.dnd_bind('<<Drop>>', self.on_drop)
            self.file_tree.drop_target_register(DND_FILES)
            self.file_tree.dnd_bind('<<Drop>>', self.on_drop)
    
    def setup_preview_bindings(self):
        """ë¯¸ë¦¬ë³´ê¸° ì´ë²¤íŠ¸ ë°”ì¸ë”©"""
        vars_to_trace = [
            self.mode_var, self.text_var, self.find_var, self.replace_var,
            self.regex_var, self.ignore_case_var, self.start_var, self.digits_var,
            self.step_var, self.template_var, self.preserve_case_var
        ]
        
        for var in vars_to_trace:
            var.trace('w', self.on_option_change)
    
    # ì—¬ê¸°ì— ëª¨ë“  ë©”ì„œë“œë“¤ì„ ê³„ì† êµ¬í˜„... (ë„ˆë¬´ ê¸¸ì–´ì„œ ì¤‘ìš”í•œ ë¶€ë¶„ë§Œ ë³´ì—¬ë“œë¦¼)
    
    def execute_rename(self):
        """ì‹¤ì œ íŒŒì¼ëª… ë³€ê²½ ì‹¤í–‰"""
        if not self.get_filtered_files():
            messagebox.showwarning("ê²½ê³ ", "ë³€ê²½í•  íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.")
            return
        
        # ë³€ê²½ ê³„íš ìƒì„±
        rename_plan = self.generate_rename_plan()
        
        if not rename_plan:
            messagebox.showinfo("ì •ë³´", "ë³€ê²½í•  íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.")
            return
        
        # ë°±ì—… ìƒì„± í™•ì¸
        if self.backup_enabled_var.get():
            backup_result = self.create_backup(rename_plan)
            if not backup_result:
                return
        
        # ì‹¤í–‰ í™•ì¸
        result = messagebox.askyesno(
            "í™•ì¸", 
            f"{len(rename_plan)}ê°œ íŒŒì¼ì˜ ì´ë¦„ì„ ë³€ê²½í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n"
            f"{'ë°±ì—…ì´ ìƒì„±ë©ë‹ˆë‹¤.' if self.backup_enabled_var.get() else 'ë°±ì—…ì´ ìƒì„±ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.'}"
        )
        
        if not result:
            return
        
        # ì§„í–‰ë¥  ì´ˆê¸°í™”
        self.progress_var.set(0)
        self.progress_text_var.set("0%")
        self.root.update()
        
        # ì‹¤í–‰
        success_count = 0
        errors = []
        total = len(rename_plan)
        
        for i, (old_path, new_path) in enumerate(rename_plan):
            try:
                # ì§„í–‰ë¥  ì—…ë°ì´íŠ¸
                progress = (i + 1) / total * 100
                self.progress_var.set(progress)
                self.progress_text_var.set(f"{progress:.1f}%")
                self.status_var.set(f"ì²˜ë¦¬ ì¤‘: {os.path.basename(old_path)}")
                self.root.update()
                
                # ì¤‘ë³µ íŒŒì¼ëª… í™•ì¸
                if os.path.exists(new_path):
                    errors.append(f"{os.path.basename(old_path)}: ëŒ€ìƒ íŒŒì¼ì´ ì´ë¯¸ ì¡´ì¬í•¨")
                    continue
                
                # íŒŒì¼ëª… ë³€ê²½
                os.rename(old_path, new_path)
                success_count += 1
                
                # ë‚´ë¶€ ëª©ë¡ ì—…ë°ì´íŠ¸
                index = self.files.index(old_path)
                self.files[index] = new_path
                
            except Exception as e:
                errors.append(f"{os.path.basename(old_path)}: {str(e)}")
        
        # ì§„í–‰ë¥  ì™„ë£Œ
        self.progress_var.set(100)
        self.progress_text_var.set("ì™„ë£Œ")
        self.status_var.set("ì‘ì—… ì™„ë£Œ")
        
        # ê²°ê³¼ ë³´ê³ 
        result_msg = f"ì„±ê³µ: {success_count}ê°œ íŒŒì¼ ë³€ê²½ë¨"
        if errors:
            result_msg += f"\nì‹¤íŒ¨: {len(errors)}ê°œ"
            if len(errors) <= 5:
                result_msg += "\n" + "\n".join(errors)
        
        messagebox.showinfo("ì‘ì—… ì™„ë£Œ", result_msg)
        
        # UI ìƒˆë¡œê³ ì¹¨
        self.refresh_file_list()
        self.update_preview()
    
    def create_backup(self, rename_plan):
        """ë°±ì—… ìƒì„±"""
        try:
            timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
            backup_dir = Path.home() / ".file_renamer_backups" / timestamp
            backup_dir.mkdir(parents=True, exist_ok=True)
            
            # ë°±ì—… ì •ë³´ ì €ì¥
            backup_info = {
                "timestamp": timestamp,
                "original_files": len(rename_plan),
                "changes": []
            }
            
            for old_path, new_path in rename_plan:
                if old_path != new_path:
                    # íŒŒì¼ ë³µì‚¬
                    backup_file = backup_dir / os.path.basename(old_path)
                    shutil.copy2(old_path, backup_file)
                    
                    backup_info["changes"].append({
                        "old_path": old_path,
                        "new_path": new_path,
                        "backup_file": str(backup_file)
                    })
            
            # ë°±ì—… ì •ë³´ íŒŒì¼ ì €ì¥
            info_file = backup_dir / "backup_info.json"
            with open(info_file, 'w', encoding='utf-8') as f:
                json.dump(backup_info, f, ensure_ascii=False, indent=2)
            
            # ë°±ì—… íˆìŠ¤í† ë¦¬ì— ì¶”ê°€
            self.backup_history.append(str(backup_dir))
            
            self.status_var.set(f"ë°±ì—… ìƒì„±: {backup_dir}")
            return True
            
        except Exception as e:
            messagebox.showerror("ë°±ì—… ì˜¤ë¥˜", f"ë°±ì—… ìƒì„± ì‹¤íŒ¨: {e}")
            return False
    
    def run(self):
        self.root.mainloop()

if __name__ == "__main__":
    app = FileManagementRenamer()
    app.run()
```

### Step 5ì—ì„œ ì¶”ê°€ëœ ê³ ê¸‰ ê¸°ëŠ¥ë“¤

#### 1. íŒŒì¼ í•„í„°ë§ ì‹œìŠ¤í…œ

ê°•ë ¥í•œ í•„í„°ë§ ì˜µì…˜ìœ¼ë¡œ ì›í•˜ëŠ” íŒŒì¼ë§Œ ì„ ë³„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

=== "í™•ì¥ì í•„í„°"
    ```
    .jpg,.png,.gif  # ì´ë¯¸ì§€ íŒŒì¼ë§Œ
    .mp4,.avi       # ë™ì˜ìƒ íŒŒì¼ë§Œ
    .txt,.md        # í…ìŠ¤íŠ¸ íŒŒì¼ë§Œ
    ```

=== "í¬ê¸° í•„í„°"
    ```
    ìµœì†Œ í¬ê¸°: 1MB     # 1MB ì´ìƒ íŒŒì¼ë§Œ
    ìµœëŒ€ í¬ê¸°: 100MB   # 100MB ì´í•˜ íŒŒì¼ë§Œ
    ```

=== "íŒŒì¼ëª… íŒ¨í„´"
    ```
    IMG_*           # IMG_ë¡œ ì‹œì‘í•˜ëŠ” íŒŒì¼
    *_backup.*      # _backupì´ í¬í•¨ëœ íŒŒì¼
    *.{jpg,png}     # jpg ë˜ëŠ” png íŒŒì¼
    ```

#### 2. ë°±ì—… ë° ì‹¤í–‰ ì·¨ì†Œ ì‹œìŠ¤í…œ

ì•ˆì „í•œ íŒŒì¼ ê´€ë¦¬ë¥¼ ìœ„í•œ ì™„ë²½í•œ ë°±ì—… ì‹œìŠ¤í…œ:

```python
# ìë™ ë°±ì—… ìƒì„±
backup_dir = ~/.file_renamer_backups/20231225_143022/
â”œâ”€â”€ backup_info.json    # ë°±ì—… ì •ë³´
â”œâ”€â”€ original_file1.txt  # ì›ë³¸ íŒŒì¼ë“¤
â”œâ”€â”€ original_file2.jpg
â””â”€â”€ ...

# ì‹¤í–‰ ì·¨ì†Œ ê¸°ëŠ¥
def undo_last_operation(self):
    """ë§ˆì§€ë§‰ ì‘ì—… ì‹¤í–‰ ì·¨ì†Œ"""
    if not self.backup_history:
        messagebox.showwarning("ê²½ê³ ", "ì‹¤í–‰ ì·¨ì†Œí•  ì‘ì—…ì´ ì—†ìŠµë‹ˆë‹¤.")
        return
    
    last_backup = self.backup_history[-1]
    # ë°±ì—…ì—ì„œ ì›ë³¸ íŒŒì¼ëª…ìœ¼ë¡œ ë³µì›
```

#### 3. í…œí”Œë¦¿ ê¸°ë°˜ ì´ë¦„ ë³€ê²½

ë”ìš± ìœ ì—°í•œ íŒŒì¼ëª… ìƒì„±ì„ ìœ„í•œ í…œí”Œë¦¿ ì‹œìŠ¤í…œ:

```python
# ì‚¬ìš© ê°€ëŠ¥í•œ í…œí”Œë¦¿ ë³€ìˆ˜
{number}      # ì—°ë²ˆ (ìë¦¿ìˆ˜ ì˜µì…˜ ì ìš©)
{name}        # íŒŒì¼ëª… (í™•ì¥ì ì œì™¸)
{ext}         # í™•ì¥ì (ì  ì œì™¸)
{filename}    # ì „ì²´ íŒŒì¼ëª…
{index}       # 0ë¶€í„° ì‹œì‘í•˜ëŠ” ì¸ë±ìŠ¤
{date}        # í˜„ì¬ ë‚ ì§œ (YYYYMMDD)
{time}        # í˜„ì¬ ì‹œê°„ (HHMMSS)
{size}        # íŒŒì¼ í¬ê¸°
{parent}      # ë¶€ëª¨ í´ë”ëª…

# í…œí”Œë¦¿ ì˜ˆì‹œ
"{date}_{number:04d}_{name}"        # 20231225_0001_photo
"[{parent}] {filename}"             # [Photos] IMG_001.jpg
"{name}_backup_{time}.{ext}"        # document_backup_143022.txt
```

#### 4. ì¼ê´„ ì²˜ë¦¬ ë° ì§„í–‰ë¥  í‘œì‹œ

ëŒ€ìš©ëŸ‰ íŒŒì¼ ì²˜ë¦¬ë¥¼ ìœ„í•œ ìµœì í™”ëœ ì¼ê´„ ì²˜ë¦¬:

- **ì§„í–‰ë¥  ë°”**: ì‹¤ì‹œê°„ ì²˜ë¦¬ ì§„í–‰ìƒí™© í‘œì‹œ
- **ìƒíƒœ ì •ë³´**: í˜„ì¬ ì²˜ë¦¬ ì¤‘ì¸ íŒŒì¼ëª… í‘œì‹œ
- **ë°±ê·¸ë¼ìš´ë“œ ì²˜ë¦¬**: UI ë¸”ë¡ ì—†ì´ ì²˜ë¦¬
- **ì—ëŸ¬ ìˆ˜ì§‘**: ì‹¤íŒ¨í•œ íŒŒì¼ë“¤ì„ ëª¨ì•„ì„œ ë³´ê³ 

#### 5. ê³ ê¸‰ UI ê¸°ëŠ¥ë“¤

=== "ë©”ë‰´ ì‹œìŠ¤í…œ"
    - **íŒŒì¼**: í”„ë¡œì íŠ¸ ì €ì¥/ë¶ˆëŸ¬ì˜¤ê¸°, ì„¤ì •
    - **í¸ì§‘**: ì„ íƒ ê´€ë¦¬, ì‹¤í–‰ ì·¨ì†Œ
    - **ë„êµ¬**: ì¤‘ë³µ íŒŒì¼ ì°¾ê¸°, íŒŒì¼ ê²€ì¦, í†µê³„
    - **ë„ì›€ë§**: ì‚¬ìš©ë²•, ì •ë³´

=== "í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤"
    ```
    Ctrl+A    # ëª¨ë“  íŒŒì¼ ì„ íƒ
    Ctrl+D    # ì„ íƒ í•´ì œ
    Ctrl+Z    # ì‹¤í–‰ ì·¨ì†Œ
    F5        # ìƒˆë¡œê³ ì¹¨
    Delete    # ì„ íƒ íŒŒì¼ ì œê±°
    ```

=== "ìƒí™©ë³„ ë©”ë‰´"
    ```python
    # íŒŒì¼ ëª©ë¡ ìš°í´ë¦­ ë©”ë‰´
    context_menu = tk.Menu(self.root, tearoff=0)
    context_menu.add_command(label="íŒŒì¼ ìœ„ì¹˜ ì—´ê¸°", command=self.open_location)
    context_menu.add_command(label="ì†ì„± ë³´ê¸°", command=self.show_properties)
    context_menu.add_command(label="ì œì™¸í•˜ê¸°", command=self.exclude_file)
    ```

#### 6. í”„ë¡œì íŠ¸ ê´€ë¦¬

ë³µì¡í•œ ì‘ì—…ì„ ìœ„í•œ í”„ë¡œì íŠ¸ ì €ì¥/ë¶ˆëŸ¬ì˜¤ê¸°:

```json
{
  "project_name": "ì‚¬ì§„ ì •ë¦¬ í”„ë¡œì íŠ¸",
  "files": ["path1", "path2", "..."],
  "settings": {
    "mode": "template",
    "template": "{date}_{number:04d}_{name}",
    "filters": {
      "extensions": [".jpg", ".png"],
      "min_size": "1MB"
    }
  },
  "created": "2023-12-25T14:30:22",
  "last_modified": "2023-12-25T15:45:30"
}
```

#### 7. íŒŒì¼ í†µê³„ ë° ë¶„ì„

ì‘ì—… ì „ íŒŒì¼ í˜„í™©ì„ íŒŒì•…í•  ìˆ˜ ìˆëŠ” í†µê³„ ê¸°ëŠ¥:

```
ğŸ“Š íŒŒì¼ í†µê³„
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ì´ íŒŒì¼ ìˆ˜: 1,234ê°œ
ì´ í¬ê¸°: 2.4 GB

í™•ì¥ìë³„:
  .jpg: 856ê°œ (69.4%)
  .png: 234ê°œ (19.0%)
  .gif: 144ê°œ (11.6%)

í¬ê¸°ë³„:
  < 1MB: 1,100ê°œ
  1-10MB: 120ê°œ
  > 10MB: 14ê°œ

ì¤‘ë³µ íŒŒì¼: 23ê°œ ë°œê²¬
```

### ì‹¤í–‰ ê²°ê³¼

![Step 5 ì‹¤í–‰ í™”ë©´](images/ch4_step5.png)

*Step 5ì—ì„œëŠ” ì „ë¬¸ì ì¸ íŒŒì¼ ê´€ë¦¬ ë„êµ¬ì— í•„ìš”í•œ ëª¨ë“  ê³ ê¸‰ ê¸°ëŠ¥ë“¤ì„ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤. ë°±ì—…, í•„í„°ë§, í…œí”Œë¦¿, í”„ë¡œì íŠ¸ ê´€ë¦¬ ë“±ìœ¼ë¡œ ì™„ì„±ë„ ë†’ì€ ë„êµ¬ê°€ ë˜ì—ˆìŠµë‹ˆë‹¤.*

## ğŸ® ë“œë˜ê·¸ ì•¤ ë“œë¡­ êµ¬í˜„

### 1. ë“œë˜ê·¸ ì•¤ ë“œë¡­ ì„¤ì •

```python linenums="113"
def setup_drag_drop(self):
    if DND_AVAILABLE:
        self.drop_label.drop_target_register(DND_FILES)
        self.drop_label.dnd_bind('<<Drop>>', self.on_drop)
        
        self.files_listbox.drop_target_register(DND_FILES)
        self.files_listbox.dnd_bind('<<Drop>>', self.on_drop)
```

!!! info "ì´ë²¤íŠ¸ ë°”ì¸ë”©"
    - `drop_target_register(DND_FILES)`: íŒŒì¼ ë“œë¡­ì„ ë°›ì„ ìˆ˜ ìˆë„ë¡ ë“±ë¡
    - `dnd_bind('<<Drop>>', handler)`: ë“œë¡­ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì—°ê²°

### 2. ë“œë¡­ ì´ë²¤íŠ¸ ì²˜ë¦¬

```python linenums="120"
def on_drop(self, event):
    files = self.root.tk.splitlist(event.data)
    self.add_files(files)
```

### 3. íŒŒì¼ ì¶”ê°€ ë‹¤ì´ì–¼ë¡œê·¸

```python linenums="124"
def add_files_dialog(self):
    from tkinter import filedialog
    files = filedialog.askopenfilenames(
        title="íŒŒì¼ ì„ íƒ",
        filetypes=[
            ("ëª¨ë“  íŒŒì¼", "*.*"),
            ("í…ìŠ¤íŠ¸ íŒŒì¼", "*.txt"),
            ("ì´ë¯¸ì§€ íŒŒì¼", "*.jpg *.jpeg *.png *.gif *.bmp"),
            ("ë¬¸ì„œ íŒŒì¼", "*.pdf *.doc *.docx")
        ]
    )
    if files:
        self.add_files(files)
```

!!! tip "íŒŒì¼ í˜•ì‹ í•„í„°"
    `filetypes` ë§¤ê°œë³€ìˆ˜ë¡œ ì‚¬ìš©ìê°€ íŠ¹ì • í˜•ì‹ì˜ íŒŒì¼ë§Œ ì„ íƒí•˜ê¸° ì‰½ê²Œ ë§Œë“­ë‹ˆë‹¤.

## ğŸ“ íŒŒì¼ ê´€ë¦¬ ë¡œì§

### 1. ìŠ¤ë§ˆíŠ¸ íŒŒì¼ ì¶”ê°€

```python linenums="137"
def add_files(self, file_paths):
    added_count = 0
    
    for file_path in file_paths:
        if os.path.isfile(file_path) and file_path not in self.files:
            self.files.append(file_path)
            file_name = os.path.basename(file_path)
            self.files_listbox.insert(tk.END, file_name)
            added_count += 1
    
    self.update_file_count()
    
    if added_count > 0:
        self.status_var.set(f"{added_count}ê°œ íŒŒì¼ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤")
    else:
        self.status_var.set("ì¶”ê°€í•  ìƒˆë¡œìš´ íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤")
```

!!! note "ì¤‘ë³µ ê²€ì‚¬"
    - `os.path.isfile()`: ì‹¤ì œ íŒŒì¼ì¸ì§€ í™•ì¸
    - `file_path not in self.files`: ì´ë¯¸ ì¶”ê°€ëœ íŒŒì¼ì¸ì§€ í™•ì¸

### 2. ì„ íƒì  íŒŒì¼ ì œê±°

```python linenums="152"
def remove_selected_files(self):
    selection = self.files_listbox.curselection()
    if selection:
        # ë’¤ì—ì„œë¶€í„° ì œê±° (ì¸ë±ìŠ¤ ë³€ê²½ ë°©ì§€)
        for index in reversed(selection):
            self.files_listbox.delete(index)
            del self.files[index]
        
        self.update_file_count()
        self.status_var.set(f"{len(selection)}ê°œ íŒŒì¼ì´ ì œê±°ë˜ì—ˆìŠµë‹ˆë‹¤")
    else:
        self.status_var.set("ì œê±°í•  íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”")
```

!!! important "ì—­ìˆœ ì œê±°"
    ë¦¬ìŠ¤íŠ¸ì—ì„œ í•­ëª©ì„ ì œê±°í•  ë•ŒëŠ” ë’¤ì—ì„œë¶€í„° ì œê±°í•´ì•¼ ì¸ë±ìŠ¤ê°€ ê¼¬ì´ì§€ ì•ŠìŠµë‹ˆë‹¤.

### 3. ì „ì²´ íŒŒì¼ ì œê±°

```python linenums="165"
def clear_all_files(self):
    count = len(self.files)
    self.files.clear()
    self.files_listbox.delete(0, tk.END)
    self.update_file_count()
    self.status_var.set(f"ëª¨ë“  íŒŒì¼({count}ê°œ)ì´ ì œê±°ë˜ì—ˆìŠµë‹ˆë‹¤")
```

### 4. íŒŒì¼ ì¹´ìš´í„° ì—…ë°ì´íŠ¸

```python linenums="172"
def update_file_count(self):
    self.count_var.set(f"íŒŒì¼ ê°œìˆ˜: {len(self.files)}")
```

## ğŸ§ª í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

### 1. ë“œë˜ê·¸ ì•¤ ë“œë¡­ í…ŒìŠ¤íŠ¸

=== "ë‹¨ì¼ íŒŒì¼"
    1. íƒìƒ‰ê¸°ì—ì„œ íŒŒì¼ í•˜ë‚˜ë¥¼ ì„ íƒ
    2. ë“œë¡­ ì˜ì—­ìœ¼ë¡œ ë“œë˜ê·¸
    3. íŒŒì¼ì´ ëª©ë¡ì— ì¶”ê°€ë˜ëŠ”ì§€ í™•ì¸

=== "ë‹¤ì¤‘ íŒŒì¼"
    1. íƒìƒ‰ê¸°ì—ì„œ ì—¬ëŸ¬ íŒŒì¼ì„ ì„ íƒ (Ctrl+í´ë¦­)
    2. ë“œë¡­ ì˜ì—­ìœ¼ë¡œ ë“œë˜ê·¸
    3. ëª¨ë“  íŒŒì¼ì´ ëª©ë¡ì— ì¶”ê°€ë˜ëŠ”ì§€ í™•ì¸

=== "í´ë” ë“œë¡­"
    1. í´ë”ë¥¼ ë“œë˜ê·¸ ì•¤ ë“œë¡­
    2. í´ë”ëŠ” ë¬´ì‹œë˜ê³  íŒŒì¼ë§Œ ì²˜ë¦¬ë˜ëŠ”ì§€ í™•ì¸

### 2. íŒŒì¼ ê´€ë¦¬ í…ŒìŠ¤íŠ¸

=== "ì¤‘ë³µ íŒŒì¼"
    1. ê°™ì€ íŒŒì¼ì„ ë‘ ë²ˆ ì¶”ê°€
    2. ì¤‘ë³µì´ ë°©ì§€ë˜ëŠ”ì§€ í™•ì¸

=== "ë‹¤ì¤‘ ì„ íƒ ì œê±°"
    1. ì—¬ëŸ¬ íŒŒì¼ì„ ì„ íƒ (Ctrl+í´ë¦­)
    2. "ì„ íƒ ì œê±°" ë²„íŠ¼ í´ë¦­
    3. ì„ íƒëœ íŒŒì¼ë“¤ë§Œ ì œê±°ë˜ëŠ”ì§€ í™•ì¸

=== "ì „ì²´ ì œê±°"
    1. ì—¬ëŸ¬ íŒŒì¼ì„ ì¶”ê°€
    2. "ëª¨ë‘ ì œê±°" ë²„íŠ¼ í´ë¦­
    3. ëª¨ë“  íŒŒì¼ì´ ì œê±°ë˜ëŠ”ì§€ í™•ì¸

## ğŸ¨ UI/UX ê°œì„ ì‚¬í•­

### 1. ì‹œê°ì  í”¼ë“œë°±

```python
# ë“œë¡­ ì˜ì—­ ê°•ì¡°
self.drop_label = ttk.Label(
    main_frame,
    text=drop_info,
    relief="solid",      # í…Œë‘ë¦¬ í‘œì‹œ
    padding="20",        # ì¶©ë¶„í•œ íŒ¨ë”©
    anchor="center"      # ì¤‘ì•™ ì •ë ¬
)
```

### 2. ìƒíƒœ ì •ë³´ í‘œì‹œ

```python
# ì‹¤ì‹œê°„ íŒŒì¼ ê°œìˆ˜ í‘œì‹œ
self.count_var.set(f"íŒŒì¼ ê°œìˆ˜: {len(self.files)}")

# ì‚¬ìš©ì ì•¡ì…˜ì— ëŒ€í•œ í”¼ë“œë°±
self.status_var.set(f"{added_count}ê°œ íŒŒì¼ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤")
```

### 3. ë‹¤ì–‘í•œ ì…ë ¥ ë°©ë²• ì§€ì›

- **ë“œë˜ê·¸ ì•¤ ë“œë¡­**: ì§ê´€ì ì¸ íŒŒì¼ ì¶”ê°€
- **íŒŒì¼ ë‹¤ì´ì–¼ë¡œê·¸**: ì „í†µì ì¸ íŒŒì¼ ì„ íƒ
- **ë‹¤ì¤‘ ì„ íƒ**: íš¨ìœ¨ì ì¸ íŒŒì¼ ê´€ë¦¬

## ğŸ” ì—ëŸ¬ ì²˜ë¦¬

### 1. ë¼ì´ë¸ŒëŸ¬ë¦¬ ëˆ„ë½ ì²˜ë¦¬

```python
try:
    from tkinterdnd2 import DND_FILES, TkinterDnD
    DND_AVAILABLE = True
except ImportError:
    DND_AVAILABLE = False
    # ê¸°ë³¸ ê¸°ëŠ¥ìœ¼ë¡œ fallback
```

### 2. íŒŒì¼ ì‹œìŠ¤í…œ ì—ëŸ¬

```python
def add_files(self, file_paths):
    added_count = 0
    
    for file_path in file_paths:
        try:
            if os.path.isfile(file_path) and file_path not in self.files:
                self.files.append(file_path)
                file_name = os.path.basename(file_path)
                self.files_listbox.insert(tk.END, file_name)
                added_count += 1
        except (OSError, PermissionError) as e:
            self.status_var.set(f"íŒŒì¼ ì ‘ê·¼ ì˜¤ë¥˜: {e}")
            continue
```


## ğŸ“š í•µì‹¬ ê°œë… ì •ë¦¬

### ë“œë˜ê·¸ ì•¤ ë“œë¡­ íŒ¨í„´

```python
# 1. ìœ„ì ¯ì„ ë“œë¡­ íƒ€ê²Ÿìœ¼ë¡œ ë“±ë¡
widget.drop_target_register(DND_FILES)

# 2. ë“œë¡­ ì´ë²¤íŠ¸ ë°”ì¸ë”©
widget.dnd_bind('<<Drop>>', self.on_drop)

# 3. ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ì—ì„œ ë°ì´í„° ì²˜ë¦¬
def on_drop(self, event):
    files = self.root.tk.splitlist(event.data)
    self.process_files(files)
```

### íŒŒì¼ ì‹œìŠ¤í…œ ì‘ì—…

```python
import os
from pathlib import Path

# íŒŒì¼ ì¡´ì¬ í™•ì¸
if os.path.isfile(file_path):
    # íŒŒì¼ ì²˜ë¦¬

# íŒŒì¼ëª… ì¶”ì¶œ
file_name = os.path.basename(file_path)

# ê²½ë¡œ ì¡°ì‘ (pathlib ì‚¬ìš© ê¶Œì¥)
path = Path(file_path)
name = path.name
extension = path.suffix
```

### ë¦¬ìŠ¤íŠ¸ ê´€ë¦¬ íŒ¨í„´

```python
# ì¤‘ë³µ ë°©ì§€ ì¶”ê°€
if item not in list:
    list.append(item)

# ì—­ìˆœ ì œê±°
for index in reversed(selection):
    del list[index]

# ì „ì²´ ì‚­ì œ
list.clear()
```

---

!!! success "Chapter 4 ì™„ë£Œ!"
    ë“œë˜ê·¸ ì•¤ ë“œë¡­ ê¸°ëŠ¥ê³¼ íŒŒì¼ ê´€ë¦¬ ê¸°ëŠ¥ì„ ì„±ê³µì ìœ¼ë¡œ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤!
    ì´ì œ ì‹¤ì œë¡œ íŒŒì¼ëª…ì„ ë³€ê²½í•˜ëŠ” í•µì‹¬ ê¸°ëŠ¥ì„ ë§Œë“¤ì–´ë³´ê² ìŠµë‹ˆë‹¤.

!!! tip "ì—°ìŠµ ê³¼ì œ"
    - íŒŒì¼ ì •ë³´ë¥¼ ë” ìì„¸íˆ í‘œì‹œí•´ë³´ê¸° (í¬ê¸°, ìˆ˜ì •ì¼ ë“±)
    - íŒŒì¼ í˜•ì‹ë³„ë¡œ ë‹¤ë¥¸ ì•„ì´ì½˜ í‘œì‹œí•´ë³´ê¸°
    - íŒŒì¼ ëª©ë¡ì„ ì €ì¥/ë¶ˆëŸ¬ì˜¤ê¸° ê¸°ëŠ¥ ì¶”ê°€í•´ë³´ê¸°
    - ë“œë¡­ ì‹œ ì‹œê°ì  íš¨ê³¼ ì¶”ê°€í•´ë³´ê¸°